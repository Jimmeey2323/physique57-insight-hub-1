import{R as Ae,j as e,e as G,X as Re,i as _,_ as le,U,T as Z,v as he,c as ie,$ as Pe,r as S,g as J,u as oe,E as ce,Z as de,a1 as ge,F as Fe,h as pe,f as Ve,J as je,ai as ve,ah as Be,an as Ie}from"./react-vendor-CYideCN0.js";import{_ as fe,$ as be,a0 as ye,a1 as Ne,B as R,d as Y,C,c as k,j as P,k as F,a3 as me,Z as ee,r as se,s as te,t as z,u as E,a8 as Le,X as Oe,a7 as ze}from"./ui-components-Cek3D08m.js";import{f as A,b as $,m as we,g as xe}from"./utils-Bswz-ULp.js";import{A as Ee,U as $e,b as He,E as Ye,S as Ue,P as Ke}from"./dashboard-misc-D1HwnLCW.js";import{R as Q,B as Ce,C as ae,X as re,Y as ne,T as W,c as ke,P as De,d as Me,e as Te,L as qe,b as Ge}from"./chart-vendor-DyOsfj4e.js";import{P as Xe,C as Qe}from"./dashboard-trainers-BqTosOpB.js";import{c as X}from"./dashboard-classes-DkM9eh--.js";const os=({isOpen:b,onClose:T,data:x})=>{if(!x)return null;const v=x.rawData||x.filteredTransactionData||[],o=Ae.useMemo(()=>{const u=v.reduce((s,w)=>s+w.paymentValue,0),m=v.length,V=new Set(v.map(s=>s.memberId)).size,B=m>0?u/m:0,H=V>0?u/V:0,I=v.reduce((s,w)=>{const n=new Date(w.paymentDate).toLocaleDateString("en-US",{month:"short",year:"numeric"});return s[n]||(s[n]={revenue:0,transactions:0,customers:new Set}),s[n].revenue+=w.paymentValue,s[n].transactions+=1,s[n].customers.add(w.memberId),s},{});Object.keys(I).forEach(s=>{I[s].uniqueCustomers=I[s].customers.size,delete I[s].customers});const y=v.reduce((s,w)=>{const n=`${w.customerName}`;return s[n]||(s[n]={name:w.customerName,revenue:0,transactions:0,email:w.customerEmail||"N/A",memberId:w.memberId}),s[n].revenue+=w.paymentValue,s[n].transactions+=1,s},{}),D=Object.values(y).sort((s,w)=>w.revenue-s.revenue).slice(0,10),a=v.reduce((s,w)=>{const n=w.paymentMethod||"Unknown";return s[n]=(s[n]||0)+w.paymentValue,s},{});return{totalRevenue:u,totalTransactions:m,uniqueCustomers:V,avgTransactionValue:B,avgRevenuePerCustomer:H,monthlyData:I,topCustomers:D,paymentMethods:a}},[v]),f=[{key:"customerName",header:"Customer",className:"min-w-[150px]",render:(u,m)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:u}),e.jsx("div",{className:"text-xs text-gray-500",children:m.customerEmail})]})},{key:"cleanedProduct",header:"Product",className:"min-w-[120px]",render:(u,m)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:u}),e.jsx(R,{variant:"outline",className:"text-xs mt-1",children:m.cleanedCategory})]})},{key:"paymentValue",header:"Amount",align:"right",render:u=>e.jsx("span",{className:"font-semibold text-emerald-600",children:A(u)})},{key:"paymentDate",header:"Date",align:"center",render:u=>e.jsx("div",{className:"text-sm",children:new Date(u).toLocaleDateString()})},{key:"paymentMethod",header:"Payment",align:"center",render:u=>e.jsx(R,{variant:"secondary",children:u||"N/A"})},{key:"soldBy",header:"Sold By",className:"min-w-[100px]",render:u=>e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:[e.jsx(U,{className:"w-3 h-3"}),u]})}];return e.jsx(fe,{open:b,onOpenChange:T,children:e.jsxs(be,{className:"max-w-7xl max-h-[90vh] overflow-y-auto",children:[e.jsx(ye,{className:"pb-4 border-b bg-gradient-to-r from-blue-50 to-purple-50 -m-6 p-6 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ne,{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5 text-blue-600"}),x.title||x.name," - Sales Analytics",e.jsx(R,{variant:"outline",className:"ml-2 text-blue-600 border-blue-200 bg-blue-50",children:x.type})]}),e.jsx(Y,{variant:"ghost",size:"sm",onClick:T,className:"hover:bg-white/50",children:e.jsx(Re,{className:"w-4 h-4"})})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[e.jsx(C,{className:"bg-gradient-to-br from-emerald-50 to-emerald-100 border-emerald-200",children:e.jsx(k,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-700",children:A(o.totalRevenue)}),e.jsx("div",{className:"text-xs text-emerald-600",children:"Total Revenue"})]})]})})}),e.jsx(C,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:e.jsx(k,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:$(o.totalTransactions)}),e.jsx("div",{className:"text-xs text-blue-600",children:"Transactions"})]})]})})}),e.jsx(C,{className:"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:e.jsx(k,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4 text-purple-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-700",children:$(o.uniqueCustomers)}),e.jsx("div",{className:"text-xs text-purple-600",children:"Customers"})]})]})})}),e.jsx(C,{className:"bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:e.jsx(k,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-orange-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-700",children:A(o.avgTransactionValue)}),e.jsx("div",{className:"text-xs text-orange-600",children:"Avg Transaction"})]})]})})}),e.jsx(C,{className:"bg-gradient-to-br from-rose-50 to-rose-100 border-rose-200",children:e.jsx(k,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4 text-rose-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-rose-700",children:A(o.avgRevenuePerCustomer)}),e.jsx("div",{className:"text-xs text-rose-600",children:"Avg per Customer"})]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs(C,{children:[e.jsx(P,{children:e.jsxs(F,{className:"text-lg flex items-center gap-2",children:[e.jsx(ie,{className:"w-5 h-5 text-blue-600"}),"Monthly Performance"]})}),e.jsx(k,{children:e.jsx(me,{className:"h-64",children:e.jsx("div",{className:"space-y-3",children:Object.entries(o.monthlyData).map(([u,m])=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:u}),e.jsxs("div",{className:"text-sm text-gray-600",children:[$(m.transactions)," transactions â€¢ ",$(m.uniqueCustomers)," customers"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"font-bold text-emerald-600",children:A(m.revenue)})})]},u))})})})]}),e.jsxs(C,{children:[e.jsx(P,{children:e.jsxs(F,{className:"text-lg flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5 text-purple-600"}),"Top Customers"]})}),e.jsx(k,{children:e.jsx(me,{className:"h-64",children:e.jsx("div",{className:"space-y-3",children:o.topCustomers.map((u,m)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-400 to-purple-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:m+1}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:u.name}),e.jsx("div",{className:"text-sm text-gray-600",children:u.email})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold text-emerald-600",children:A(u.revenue)}),e.jsxs("div",{className:"text-sm text-gray-600",children:[$(u.transactions)," orders"]})]})]},u.memberId))})})})]})]}),e.jsxs(C,{children:[e.jsx(P,{children:e.jsxs(F,{className:"text-lg flex items-center gap-2",children:[e.jsx(Pe,{className:"w-5 h-5 text-green-600"}),"Transaction Details (",$(v.length)," records)"]})}),e.jsx(k,{className:"p-0",children:e.jsx(ee,{data:v,columns:f,headerGradient:"from-emerald-600 to-blue-600",maxHeight:"400px"})})]})]})})},We=({isOpen:b,onClose:T,data:x,type:v})=>{if(!x)return null;const o=S.useMemo(()=>{const y=x.filteredTransactionData||x.rawData||x.transactionData||[],D=x.isDynamic&&x.totalRevenue!==void 0?x.totalRevenue:y.reduce((t,h)=>t+(h.paymentValue||0),0),a=x.isDynamic&&x.totalTransactions!==void 0?x.totalTransactions:y.length,s=x.isDynamic&&x.totalCustomers!==void 0?x.totalCustomers:new Set(y.map(t=>t.memberId||t.customerEmail)).size,w=a>0?D/a:0;new Set(y.map(t=>t.cleanedProduct||t.paymentItem)).size;const n=y.reduce((t,h)=>{const N=h.paymentMethod||"Unknown";return t[N]||(t[N]={count:0,revenue:0}),t[N].count+=1,t[N].revenue+=h.paymentValue||0,t},{}),i=y.reduce((t,h)=>{const N=h.cleanedCategory||"Other";return t[N]||(t[N]={count:0,revenue:0,customers:new Set}),t[N].count+=1,t[N].revenue+=h.paymentValue||0,t[N].customers.add(h.memberId||h.customerEmail),t},{}),p=y.reduce((t,h)=>{if(!h.paymentDate)return t;const N=new Date(h.paymentDate),r=N.getHours(),d=N.toLocaleDateString("en-US",{weekday:"long"}),g=N.toLocaleDateString("en-US",{month:"long",year:"numeric"});return t.hourly[r]||(t.hourly[r]={transactions:0,revenue:0}),t.hourly[r].transactions+=1,t.hourly[r].revenue+=h.paymentValue||0,t.weekly[d]||(t.weekly[d]={transactions:0,revenue:0}),t.weekly[d].transactions+=1,t.weekly[d].revenue+=h.paymentValue||0,t.monthly[g]||(t.monthly[g]={transactions:0,revenue:0}),t.monthly[g].transactions+=1,t.monthly[g].revenue+=h.paymentValue||0,t},{hourly:{},weekly:{},monthly:{}}),c=y.reduce((t,h)=>{const N=h.memberId||h.customerEmail;if(!N)return t;t[N]||(t[N]={email:h.customerEmail||"N/A",transactions:0,totalSpent:0,avgTransactionValue:0,lastTransaction:null,categories:new Set}),t[N].transactions+=1,t[N].totalSpent+=h.paymentValue||0,t[N].categories.add(h.cleanedCategory||"Other");const r=new Date(h.paymentDate);return(!t[N].lastTransaction||r>new Date(t[N].lastTransaction))&&(t[N].lastTransaction=h.paymentDate),t},{});return Object.values(c).forEach(t=>{t.avgTransactionValue=t.transactions>0?t.totalSpent/t.transactions:0,t.categories=Array.from(t.categories)}),{...x,totalRevenue:D,totalTransactions:a,uniqueCustomers:s,avgTransactionValue:w,paymentMethodBreakdown:n,categoryBreakdown:i,timeAnalysis:p,customerAnalysis:c}},[x]),f=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#F97316","#06B6D4","#84CC16"],u=()=>v==="trainer"?`${x.name||"Trainer"} - Performance Analytics`:v==="product"?`${x.name||"Product"} - Sales Analytics`:v==="category"?`${x.name||"Category"} - Performance Analysis`:v==="metric"?"Sales Performance - Detailed Analytics":`${x.name||"Item"} - Comprehensive Analysis`,m=()=>v==="trainer"?"Performance insights and customer engagement metrics":v==="product"?"Comprehensive sales performance and customer behavior analysis":v==="category"?"Category performance breakdown with customer insights":"Detailed analytics dashboard with transactional insights",V=()=>e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(C,{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white border-0 shadow-xl",children:e.jsxs(k,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(_,{className:"w-6 h-6 text-blue-100"}),e.jsx(R,{className:"bg-white/20 text-white border-0 text-xs",children:"Revenue"})]}),e.jsx("div",{className:"text-2xl font-bold",children:A(o.totalRevenue)}),e.jsxs("div",{className:"text-blue-100 text-sm flex items-center gap-1 mt-1",children:[e.jsx(pe,{className:"w-3 h-3"}),"Total Revenue Generated"]})]})}),e.jsx(C,{className:"bg-gradient-to-br from-green-500 to-green-600 text-white border-0 shadow-xl",children:e.jsxs(k,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(U,{className:"w-6 h-6 text-green-100"}),e.jsx(R,{className:"bg-white/20 text-white border-0 text-xs",children:"Customers"})]}),e.jsx("div",{className:"text-2xl font-bold",children:$(o.uniqueCustomers)}),e.jsxs("div",{className:"text-green-100 text-sm flex items-center gap-1 mt-1",children:[e.jsx(Z,{className:"w-3 h-3"}),"Unique Customers Served"]})]})}),e.jsx(C,{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white border-0 shadow-xl",children:e.jsxs(k,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(le,{className:"w-6 h-6 text-purple-100"}),e.jsx(R,{className:"bg-white/20 text-white border-0 text-xs",children:"Volume"})]}),e.jsx("div",{className:"text-2xl font-bold",children:$(o.totalTransactions)}),e.jsxs("div",{className:"text-purple-100 text-sm flex items-center gap-1 mt-1",children:[e.jsx(J,{className:"w-3 h-3"}),"Total Transactions"]})]})}),e.jsx(C,{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white border-0 shadow-xl",children:e.jsxs(k,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(G,{className:"w-6 h-6 text-orange-100"}),e.jsx(R,{className:"bg-white/20 text-white border-0 text-xs",children:"Average"})]}),e.jsx("div",{className:"text-2xl font-bold",children:A(o.avgTransactionValue)}),e.jsxs("div",{className:"text-orange-100 text-sm flex items-center gap-1 mt-1",children:[e.jsx(oe,{className:"w-3 h-3"}),"Avg Transaction Value"]})]})})]}),B=()=>{const y=Object.entries(o.timeAnalysis.hourly).map(([a,s])=>({hour:`${a}:00`,transactions:s.transactions,revenue:s.revenue})).sort((a,s)=>parseInt(a.hour)-parseInt(s.hour)),D=Object.entries(o.paymentMethodBreakdown).map(([a,s])=>({method:a,revenue:s.revenue,count:s.count})).sort((a,s)=>s.revenue-a.revenue);return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(C,{className:"bg-gradient-to-br from-slate-50 to-slate-100 border-slate-200",children:[e.jsx(P,{children:e.jsxs(F,{className:"flex items-center gap-2 text-slate-800",children:[e.jsx(Ve,{className:"w-5 h-5"}),"Hourly Transaction Patterns"]})}),e.jsx(k,{children:e.jsx(Q,{width:"100%",height:250,children:e.jsxs(Ce,{data:y,children:[e.jsx(ae,{strokeDasharray:"3 3"}),e.jsx(re,{dataKey:"hour"}),e.jsx(ne,{}),e.jsx(W,{formatter:(a,s)=>[s==="revenue"?A(a):$(a),s==="revenue"?"Revenue":"Transactions"]}),e.jsx(ke,{dataKey:"transactions",fill:"#3B82F6",name:"transactions"})]})})})]}),e.jsxs(C,{className:"bg-gradient-to-br from-slate-50 to-slate-100 border-slate-200",children:[e.jsx(P,{children:e.jsxs(F,{className:"flex items-center gap-2 text-slate-800",children:[e.jsx(je,{className:"w-5 h-5"}),"Payment Method Distribution"]})}),e.jsx(k,{children:e.jsx(Q,{width:"100%",height:250,children:e.jsxs(De,{children:[e.jsx(Me,{dataKey:"revenue",data:D,cx:"50%",cy:"50%",outerRadius:80,label:({method:a,percent:s})=>`${a}: ${(s*100).toFixed(0)}%`,children:D.map((a,s)=>e.jsx(Te,{fill:f[s%f.length]},`cell-${s}`))}),e.jsx(W,{formatter:a=>A(a)})]})})})]})]})},H=()=>{const y=Object.values(o.customerAnalysis).sort((a,s)=>s.totalSpent-a.totalSpent).slice(0,50),D=[{key:"email",header:"Customer",render:a=>e.jsx("div",{className:"font-medium text-slate-800 truncate max-w-[200px]",title:a,children:a})},{key:"transactions",header:"Transactions",align:"center",render:a=>e.jsx(R,{className:"bg-blue-100 text-blue-800",children:$(a)})},{key:"totalSpent",header:"Total Spent",align:"center",render:a=>e.jsx("span",{className:"font-semibold text-green-600",children:A(a)})},{key:"avgTransactionValue",header:"Avg Order Value",align:"center",render:a=>e.jsx("span",{className:"font-medium text-purple-600",children:A(a)})},{key:"categories",header:"Categories",align:"center",render:a=>e.jsxs("div",{className:"flex flex-wrap gap-1 max-w-[150px]",children:[a.slice(0,2).map((s,w)=>e.jsx(R,{variant:"outline",className:"text-xs",children:s.length>8?`${s.substring(0,8)}...`:s},w)),a.length>2&&e.jsxs(R,{variant:"outline",className:"text-xs",children:["+",a.length-2]})]})},{key:"lastTransaction",header:"Last Purchase",align:"center",render:a=>e.jsx("span",{className:"text-sm text-slate-600",children:a?new Date(a).toLocaleDateString():"N/A"})}];return e.jsxs(C,{className:"bg-gradient-to-br from-slate-50 to-slate-100",children:[e.jsx(P,{children:e.jsxs(F,{className:"flex items-center gap-2 text-slate-800",children:[e.jsx(U,{className:"w-5 h-5"}),"Top Customers Analysis",e.jsxs(R,{className:"bg-blue-100 text-blue-800 ml-auto",children:[y.length," customers"]})]})}),e.jsx(k,{className:"p-0",children:e.jsx(ee,{data:y,columns:D,maxHeight:"400px",stickyHeader:!0,showFooter:!1})})]})},I=()=>{const y=(x.rawData||[]).slice(0,100),D=[{key:"paymentDate",header:"Date",render:a=>e.jsx("span",{className:"font-mono text-sm",children:a?new Date(a).toLocaleDateString():"N/A"})},{key:"customerEmail",header:"Customer",render:a=>e.jsx("div",{className:"font-medium text-slate-700 truncate max-w-[180px]",title:a,children:a||"Anonymous"})},{key:"cleanedProduct",header:"Product/Service",render:(a,s)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-800 truncate max-w-[200px]",title:a,children:a||s.membershipName||"N/A"}),e.jsx("div",{className:"text-xs text-slate-500",children:s.cleanedCategory||"Uncategorized"})]})},{key:"paymentValue",header:"Amount",align:"center",render:(a,s)=>e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-semibold text-green-600",children:A(a||0)}),s.discountAmount&&e.jsxs("div",{className:"text-xs text-red-500",children:["-",A(s.discountAmount)]})]})},{key:"paymentMethod",header:"Payment",align:"center",render:a=>e.jsx(R,{variant:"outline",className:"text-xs",children:a||"N/A"})},{key:"soldBy",header:"Sold By",render:a=>e.jsx("span",{className:"text-sm text-slate-600",children:a||"System"})}];return e.jsxs(C,{className:"bg-gradient-to-br from-slate-50 to-slate-100",children:[e.jsx(P,{children:e.jsxs(F,{className:"flex items-center gap-2 text-slate-800",children:[e.jsx(ce,{className:"w-5 h-5"}),"Transaction Details",e.jsxs(R,{className:"bg-purple-100 text-purple-800 ml-auto",children:[y.length," transactions"]})]})}),e.jsx(k,{className:"p-0",children:e.jsx(ee,{data:y,columns:D,maxHeight:"500px",stickyHeader:!0,showFooter:!1})})]})};return e.jsx(fe,{open:b,onOpenChange:T,children:e.jsxs(be,{className:"max-w-[95vw] max-h-[95vh] overflow-hidden bg-gradient-to-br from-white via-slate-50/50 to-white border-0 shadow-2xl",children:[e.jsx(ye,{className:"pb-6 border-b border-slate-200 bg-gradient-to-r from-slate-900 via-blue-900 to-purple-900 text-white -m-6 mb-6 p-6 rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Ne,{className:"text-3xl font-bold bg-gradient-to-r from-white via-blue-100 to-purple-100 bg-clip-text text-transparent",children:u()}),e.jsx("p",{className:"text-slate-200 mt-2 text-lg",children:m()})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(R,{className:"bg-white/20 text-white border-0 flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),"Live Analytics"]}),e.jsx(Y,{variant:"outline",onClick:T,className:"bg-white/10 border-white/20 text-white hover:bg-white/20",children:"Close"})]})]})}),e.jsxs("div",{className:"overflow-y-auto max-h-[calc(95vh-120px)] space-y-8 p-1",children:[V(),e.jsxs(se,{defaultValue:"overview",className:"w-full",children:[e.jsxs(te,{className:"grid w-full grid-cols-5 bg-slate-100 h-12",children:[e.jsxs(z,{value:"overview",className:"gap-2 font-medium",children:[e.jsx(oe,{className:"w-4 h-4"}),"Overview"]}),e.jsxs(z,{value:"analytics",className:"gap-2 font-medium",children:[e.jsx(G,{className:"w-4 h-4"}),"Analytics"]}),e.jsxs(z,{value:"customers",className:"gap-2 font-medium",children:[e.jsx(U,{className:"w-4 h-4"}),"Customers"]}),e.jsxs(z,{value:"transactions",className:"gap-2 font-medium",children:[e.jsx(ce,{className:"w-4 h-4"}),"Transactions"]}),e.jsxs(z,{value:"insights",className:"gap-2 font-medium",children:[e.jsx(de,{className:"w-4 h-4"}),"Insights"]})]}),e.jsxs(E,{value:"overview",className:"space-y-6 mt-6",children:[B(),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(C,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:[e.jsx(P,{children:e.jsxs(F,{className:"text-blue-800 flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5"}),"Performance Summary"]})}),e.jsxs(k,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Revenue Growth"}),e.jsxs(R,{className:"bg-green-100 text-green-800",children:["+",(Math.random()*20+5).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Customer Retention"}),e.jsxs(R,{className:"bg-blue-100 text-blue-800",children:[(Math.random()*15+80).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Market Share"}),e.jsxs(R,{className:"bg-purple-100 text-purple-800",children:[(Math.random()*10+15).toFixed(1),"%"]})]})]})]}),e.jsxs(C,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:[e.jsx(P,{children:e.jsxs(F,{className:"text-green-800 flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5"}),"Key Metrics"]})}),e.jsxs(k,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Conversion Rate"}),e.jsxs("span",{className:"font-bold text-green-800",children:[(Math.random()*10+15).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Customer LTV"}),e.jsx("span",{className:"font-bold text-green-800",children:A(Math.random()*500+200)})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Repeat Rate"}),e.jsxs("span",{className:"font-bold text-green-800",children:[(Math.random()*20+60).toFixed(1),"%"]})]})]})]}),e.jsxs(C,{className:"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:[e.jsx(P,{children:e.jsxs(F,{className:"text-purple-800 flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5"}),"Category Breakdown"]})}),e.jsx(k,{className:"space-y-3",children:Object.entries(o.categoryBreakdown).slice(0,3).map(([y,D])=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"text-purple-700 font-medium truncate",children:y}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold text-purple-800",children:A(D.revenue)}),e.jsxs("div",{className:"text-xs text-purple-600",children:[D.count," sales"]})]})]},y))})]})]})]}),e.jsx(E,{value:"analytics",className:"space-y-6 mt-6",children:B()}),e.jsx(E,{value:"customers",className:"space-y-6 mt-6",children:H()}),e.jsx(E,{value:"transactions",className:"space-y-6 mt-6",children:I()}),e.jsx(E,{value:"insights",className:"space-y-6 mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs(C,{className:"bg-gradient-to-br from-amber-50 to-amber-100 border-amber-200",children:[e.jsx(P,{children:e.jsxs(F,{className:"text-amber-800 flex items-center gap-2",children:[e.jsx(de,{className:"w-5 h-5"}),"AI-Powered Insights"]})}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-white rounded-lg border-l-4 border-blue-400",children:[e.jsx("div",{className:"font-semibold text-blue-800 mb-1",children:"Revenue Optimization"}),e.jsx("div",{className:"text-sm text-blue-600",children:"Peak sales occur between 6-8 PM. Consider targeted promotions during this window."})]}),e.jsxs("div",{className:"p-4 bg-white rounded-lg border-l-4 border-green-400",children:[e.jsx("div",{className:"font-semibold text-green-800 mb-1",children:"Customer Behavior"}),e.jsx("div",{className:"text-sm text-green-600",children:"High-value customers prefer premium services. Upselling opportunities detected."})]}),e.jsxs("div",{className:"p-4 bg-white rounded-lg border-l-4 border-purple-400",children:[e.jsx("div",{className:"font-semibold text-purple-800 mb-1",children:"Market Trend"}),e.jsx("div",{className:"text-sm text-purple-600",children:"Increasing demand for digital payments. Mobile optimization recommended."})]})]})]}),e.jsxs(C,{className:"bg-gradient-to-br from-red-50 to-red-100 border-red-200",children:[e.jsx(P,{children:e.jsxs(F,{className:"text-red-800 flex items-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5"}),"Recommendations"]})}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-white rounded-lg",children:[e.jsx("div",{className:"font-semibold text-slate-800 mb-2",children:"ðŸŽ¯ Immediate Actions"}),e.jsxs("ul",{className:"text-sm text-slate-600 space-y-1 ml-4 list-disc",children:[e.jsx("li",{children:"Optimize pricing for peak hours"}),e.jsx("li",{children:"Launch loyalty program for top customers"}),e.jsx("li",{children:"Improve mobile payment experience"})]})]}),e.jsxs("div",{className:"p-4 bg-white rounded-lg",children:[e.jsx("div",{className:"font-semibold text-slate-800 mb-2",children:"ðŸ“ˆ Long-term Strategy"}),e.jsxs("ul",{className:"text-sm text-slate-600 space-y-1 ml-4 list-disc",children:[e.jsx("li",{children:"Expand high-performing categories"}),e.jsx("li",{children:"Develop customer retention programs"}),e.jsx("li",{children:"Implement predictive analytics"})]})]})]})]})]})})]})]})]})})},Ze={DollarSign:_,ShoppingCart:le,Activity:J,Users:U,Target:Z,Calendar:ie,CreditCard:je,ArrowDownRight:ve},_e=({data:b,onMetricClick:T})=>{const{metrics:x}=we(b),v=o=>{if(T){const f=b.reduce((B,H)=>B+(H.paymentValue||0),0),u=b.length,m=new Set(b.map(B=>B.memberId||B.customerEmail)).size,V={title:o.title,name:o.title,type:"metric",totalRevenue:f,grossRevenue:f,netRevenue:f,totalValue:f,totalCurrent:f,metricValue:f,transactions:u,totalTransactions:u,uniqueMembers:m,totalCustomers:m,totalChange:o.change,rawData:b,filteredTransactionData:b,months:{},monthlyValues:{},isDynamic:!0,calculatedFromFiltered:!0};T(V)}};return x.length===0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(8)].map((o,f)=>e.jsx(C,{className:"bg-gray-100 animate-pulse",children:e.jsx(k,{className:"p-6",children:e.jsx("div",{className:"h-20 bg-gray-200 rounded"})})},f))}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:x.map((o,f)=>{const u=Ze[o.icon]||_,m=o.change>0;return e.jsx(C,{className:X("bg-white/95 backdrop-blur-sm shadow-2xl border border-white/20 overflow-hidden hover:shadow-3xl transition-all duration-700 group cursor-pointer","hover:scale-[1.02] hover:-translate-y-1 transform-gpu"),onClick:()=>v(o),style:{animationDelay:`${f*150}ms`},children:e.jsxs(k,{className:"p-0",children:[e.jsxs("div",{className:`bg-gradient-to-br ${o.color==="blue"?"from-blue-500 via-blue-600 to-indigo-700":o.color==="green"?"from-green-500 via-green-600 to-teal-700":o.color==="purple"?"from-purple-500 via-purple-600 to-violet-700":o.color==="orange"?"from-orange-500 via-orange-600 to-red-700":o.color==="cyan"?"from-cyan-500 via-cyan-600 to-blue-700":o.color==="pink"?"from-pink-500 via-pink-600 to-rose-700":o.color==="red"?"from-red-500 via-red-600 to-rose-700":"from-amber-500 via-amber-600 to-orange-700"} p-6 text-white relative overflow-hidden`,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/0 via-white/10 to-white/0 transform -skew-x-12 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000"}),e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 transform translate-x-10 -translate-y-10 opacity-10 group-hover:opacity-20 transition-opacity duration-500",children:e.jsx(u,{className:"w-24 h-24"})}),e.jsx("div",{className:"absolute bottom-0 left-0 w-16 h-16 transform -translate-x-8 translate-y-8 opacity-5",children:e.jsx(u,{className:"w-16 h-16"})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-white/20 backdrop-blur-sm rounded-xl shadow-lg group-hover:bg-white/30 transition-colors duration-300",children:e.jsx(u,{className:"w-5 h-5"})}),e.jsx("h3",{className:"font-semibold text-sm tracking-wide",children:o.title})]}),e.jsxs("div",{className:X("flex flex-col items-center gap-1.5 px-3 py-2 rounded-full backdrop-blur-sm border transition-all duration-300 shrink-0 group","bg-white/0 hover:bg-white/95 border-white/30 hover:border-white/50","shadow-lg hover:shadow-xl transform hover:scale-105"),children:[e.jsxs("div",{className:X("flex items-center gap-1.5 transition-colors duration-300",m?"text-green-200 group-hover:text-green-600":"text-red-200 group-hover:text-red-600"),children:[m?e.jsx(Be,{className:"w-4 h-4"}):e.jsx(ve,{className:"w-4 h-4"}),e.jsxs("span",{className:"font-bold text-sm",children:[m?"+":"",o.change.toFixed(1),"%"]})]}),o.changeDetails?.isSignificant&&e.jsx("div",{className:X("text-xs px-2 py-0.5 rounded-full font-bold transition-colors duration-300","text-white/80 group-hover:text-slate-700",o.changeDetails.trend==="strong"?"bg-white/20 group-hover:bg-white/90":"bg-white/10 group-hover:bg-white/70"),children:o.changeDetails.trend.toUpperCase()})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx("p",{className:"text-4xl font-bold mb-2 tracking-tight group-hover:text-white/95 transition-colors duration-300",children:o.value})}),e.jsx("div",{className:"pt-3 border-t border-white/20",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/70 font-medium uppercase tracking-wider",children:"Previous"}),e.jsx("div",{className:"text-sm font-semibold text-white/90",children:o.previousValue})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-white/70 font-medium uppercase tracking-wider",children:"Difference"}),e.jsxs("div",{className:X("text-sm font-bold",m?"text-green-200":"text-red-200"),children:[m?"+":"",A(Math.abs(o.comparison.difference))]})]})]})})]})]}),e.jsx("div",{className:"p-4 bg-gradient-to-r from-slate-50 to-gray-50 border-t border-white/20",children:e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:o.description})})]})},f)})})},Je=({data:b})=>{const[T,x]=S.useState("6m"),[v,o]=S.useState("revenue"),[f,u]=S.useState("revenue"),m=S.useMemo(()=>{if(!b||b.length===0)return[];const n=new Date;let i=new Date;switch(T){case"1m":i.setMonth(n.getMonth()-1);break;case"3m":i.setMonth(n.getMonth()-3);break;case"6m":i.setMonth(n.getMonth()-6);break;case"1y":i.setFullYear(n.getFullYear()-1);break;default:return b}return b.filter(p=>{if(!p.paymentDate)return!1;const c=new Date(p.paymentDate);return c>=i&&c<=n})},[b,T]),V=S.useMemo(()=>{if(!m.length)return[];const n=m.reduce((i,p)=>{if(!p.paymentDate)return i;const c=new Date(p.paymentDate),t=`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}`;return i[t]||(i[t]={month:c.toLocaleDateString("en",{month:"short",year:"numeric"}),revenue:0,transactions:0,customers:new Set}),i[t].revenue+=p.paymentValue||0,i[t].transactions+=1,i[t].customers.add(p.memberId),i},{});return Object.values(n).map(i=>({...i,customers:i.customers.size})).sort((i,p)=>i.month.localeCompare(p.month))},[m]),B=S.useMemo(()=>{if(!m.length)return[];const n=m.reduce((c,t)=>{const h=t.cleanedProduct||"Unknown Product";return c[h]||(c[h]={name:h,revenue:0,transactions:0,customers:new Set,units:0}),c[h].revenue+=t.paymentValue||0,c[h].transactions+=1,c[h].customers.add(t.memberId),c[h].units+=1,c},{}),i=Object.values(n).map(c=>({...c,customers:c.customers.size}));let p;switch(f){case"transactions":p=i.sort((c,t)=>t.transactions-c.transactions);break;case"customers":p=i.sort((c,t)=>t.customers-c.customers);break;case"units":p=i.sort((c,t)=>t.units-c.units);break;default:p=i.sort((c,t)=>t.revenue-c.revenue)}return p.slice(0,10)},[m,f]),H=S.useMemo(()=>{if(!m.length)return[];const n=m.reduce((i,p)=>{const c=p.cleanedCategory||"Uncategorized";return i[c]||(i[c]=0),i[c]+=p.paymentValue||0,i},{});return Object.entries(n).map(([i,p])=>({name:i,value:p})).sort((i,p)=>p.value-i.value)},[m]),I=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D","#FFC0CB","#FFD700","#FF6347","#98FB98"],y=(n,i)=>i==="revenue"||i==="value"?A(Number(n)):String(n),D=S.useCallback(n=>{x(n)},[]),a=S.useCallback(n=>{o(n)},[]),s=S.useCallback(n=>{u(n)},[]);if(!b||b.length===0)return e.jsxs(C,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:[e.jsx(P,{children:e.jsxs(F,{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5 text-blue-600"}),"Interactive Sales Charts"]})}),e.jsx(k,{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-slate-600",children:"No data available for charts"})})]});const w=()=>{switch(v){case"revenue":return e.jsx(Q,{width:"100%",height:400,children:e.jsxs(qe,{data:V,children:[e.jsx(ae,{strokeDasharray:"3 3"}),e.jsx(re,{dataKey:"month"}),e.jsx(ne,{tickFormatter:n=>A(n)}),e.jsx(W,{formatter:y}),e.jsx(Ge,{type:"monotone",dataKey:"revenue",stroke:"#2563eb",strokeWidth:3,dot:{fill:"#2563eb",strokeWidth:2,r:4}})]})});case"products":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(Y,{variant:f==="revenue"?"default":"outline",size:"sm",onClick:()=>s("revenue"),children:"Revenue"}),e.jsx(Y,{variant:f==="transactions"?"default":"outline",size:"sm",onClick:()=>s("transactions"),children:"Transactions"}),e.jsx(Y,{variant:f==="customers"?"default":"outline",size:"sm",onClick:()=>s("customers"),children:"Customers"}),e.jsx(Y,{variant:f==="units"?"default":"outline",size:"sm",onClick:()=>s("units"),children:"Units Sold"})]}),e.jsx(Q,{width:"100%",height:400,children:e.jsxs(Ce,{data:B,margin:{left:20,right:20,top:20,bottom:60},children:[e.jsx(ae,{strokeDasharray:"3 3"}),e.jsx(re,{dataKey:"name",angle:-45,textAnchor:"end",height:100,interval:0}),e.jsx(ne,{tickFormatter:n=>f==="revenue"?A(n):$(n)}),e.jsx(W,{formatter:(n,i)=>f==="revenue"?A(Number(n)):$(Number(n))}),e.jsx(ke,{dataKey:f,fill:"#2563eb"})]})})]});case"categories":return e.jsx(Q,{width:"100%",height:400,children:e.jsxs(De,{children:[e.jsx(Me,{data:H,cx:"50%",cy:"50%",labelLine:!1,label:({name:n,percent:i})=>`${n} ${(i*100).toFixed(0)}%`,outerRadius:120,fill:"#8884d8",dataKey:"value",children:H.map((n,i)=>e.jsx(Te,{fill:I[i%I.length]},`cell-${i}`))}),e.jsx(W,{formatter:y})]})});default:return null}};return e.jsxs(C,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:[e.jsx(P,{className:"pb-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs(F,{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5 text-blue-600"}),"Interactive Sales Charts"]})}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:[e.jsx(ie,{className:"w-4 h-4"}),"Time Range:"]}),[{key:"1m",label:"Last Month"},{key:"3m",label:"Last 3 Months"},{key:"6m",label:"Last 6 Months"},{key:"1y",label:"Last Year"}].map(({key:n,label:i})=>e.jsx(Y,{variant:T===n?"default":"outline",size:"sm",onClick:()=>D(n),children:i},n))]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:[e.jsx(pe,{className:"w-4 h-4"}),"Chart Type:"]}),e.jsxs(Y,{variant:v==="revenue"?"default":"outline",size:"sm",onClick:()=>a("revenue"),className:"flex items-center gap-1",children:[e.jsx(Ie,{className:"w-4 h-4"}),"Revenue Trend"]}),e.jsxs(Y,{variant:v==="products"?"default":"outline",size:"sm",onClick:()=>a("products"),className:"flex items-center gap-1",children:[e.jsx(G,{className:"w-4 h-4"}),"Top 10 Products"]}),e.jsxs(Y,{variant:v==="categories"?"default":"outline",size:"sm",onClick:()=>a("categories"),className:"flex items-center gap-1",children:[e.jsx(ge,{className:"w-4 h-4"}),"Categories"]})]})]})}),e.jsx(k,{children:w()})]})},es=({data:b})=>{const{metrics:T}=we(b),x=T.filter(o=>["Sales Revenue","Transactions","Unique Members"].includes(o.title)).map(o=>({location:o.title,label:o.description,value:o.value})),v=e.jsx(Oe,{salesData:b,defaultFileName:"sales-analytics-filtered",size:"sm",variant:"ghost"});return e.jsx(Le,{title:"Sales Analytics",subtitle:"Comprehensive analysis of sales performance, revenue trends, and customer insights",variant:"sales",metrics:x,exportButton:v})},ue=[{id:"all",name:"All Locations",fullName:"All Locations"},{id:"kwality",name:"Kwality House, Kemps Corner",fullName:"Kwality House, Kemps Corner"},{id:"supreme",name:"Supreme HQ, Bandra",fullName:"Supreme HQ, Bandra"},{id:"kenkere",name:"Kenkere House",fullName:"Kenkere House"}],cs=({data:b})=>{const[T,x]=S.useState("all"),[v,o]=S.useState("classic"),[f,u]=S.useState(!1),[m,V]=S.useState(null),[B,H]=S.useState("metric"),[I,y]=S.useState(new Set),[D,a]=S.useState("revenue"),[s,w]=S.useState(()=>({dateRange:xe(),location:[],category:[],product:[],soldBy:[],paymentMethod:[]})),n=(r,d=!1)=>{let g=[...r];if(T!=="all"&&(g=g.filter(M=>T==="kwality"?M.calculatedLocation==="Kwality House, Kemps Corner":T==="supreme"?M.calculatedLocation==="Supreme HQ, Bandra":M.calculatedLocation?.includes("Kenkere")||M.calculatedLocation==="Kenkere House")),!d&&(s.dateRange.start||s.dateRange.end)){const M=s.dateRange.start?new Date(s.dateRange.start):null,l=s.dateRange.end?(()=>{const j=new Date(s.dateRange.end);return j.setHours(23,59,59,999),j})():null;g=g.filter(j=>{if(!j.paymentDate)return!1;let L=null;const K=j.paymentDate.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(K){const[,O,q,Se]=K;L=new Date(parseInt(Se),parseInt(q)-1,parseInt(O))}else{const O=[new Date(j.paymentDate),new Date(j.paymentDate.replace(/(\d{2})\/(\d{2})\/(\d{4})/,"$3-$2-$1")),new Date(j.paymentDate.replace(/(\d{2})\/(\d{2})\/(\d{4})/,"$2/$1/$3"))];for(const q of O)if(!isNaN(q.getTime())&&q.getFullYear()>1900&&q.getFullYear()<2100){L=q;break}}return!(!L||isNaN(L.getTime())||M&&L<M||l&&L>l)})}return s.category?.length&&(g=g.filter(M=>s.category.some(l=>M.cleanedCategory?.toLowerCase().includes(l.toLowerCase())))),s.paymentMethod?.length&&(g=g.filter(M=>s.paymentMethod.some(l=>M.paymentMethod?.toLowerCase().includes(l.toLowerCase())))),s.soldBy?.length&&(g=g.filter(M=>s.soldBy.some(l=>M.soldBy?.toLowerCase().includes(l.toLowerCase())))),s.minAmount&&(g=g.filter(M=>(M.paymentValue||0)>=s.minAmount)),s.maxAmount&&(g=g.filter(M=>(M.paymentValue||0)<=s.maxAmount)),g},i=S.useMemo(()=>n(b),[b,s,T]),p=S.useMemo(()=>n(b,!0),[b,T]),c=r=>{let d=i,g="product";r.rawData&&Array.isArray(r.rawData)&&r.rawData.length>0?d=r.rawData:Array.isArray(r)&&r.length>0?d=r:r.transactionData&&Array.isArray(r.transactionData)&&r.transactionData.length>0?d=r.transactionData:r.currentYearRawData&&r.lastYearRawData?d=[...r.currentYearRawData,...r.lastYearRawData]:d=i.filter(l=>{let j=!1;const L=[r.name,r.product,r.productName,r.paymentItem,r.cleanedProduct,r.membership,r.membershipType,r.item].filter(Boolean),K=[r.category,r.cleanedCategory,r.paymentCategory].filter(Boolean);for(const O of L)if(l.cleanedProduct===O||l.paymentItem===O||l.membershipType===O||l.paymentItem&&l.paymentItem.includes(O)||l.cleanedProduct&&l.cleanedProduct.includes(O)){j=!0;break}if(!j){for(const O of K)if(l.cleanedCategory===O||l.paymentCategory===O||l.cleanedCategory&&l.cleanedCategory.includes(O)){j=!0,g="category";break}}return r.soldBy&&l.soldBy===r.soldBy&&(j=!0,g="member"),r.paymentMethod&&l.paymentMethod===r.paymentMethod&&(j=!0,g="product"),j});const M={...r,rawData:d,filteredTransactionData:d,totalRevenue:d.reduce((l,j)=>l+(j.paymentValue||0),0),grossRevenue:d.reduce((l,j)=>l+(j.paymentValue||0),0),netRevenue:d.reduce((l,j)=>l+(j.paymentValue||0),0),totalValue:d.reduce((l,j)=>l+(j.paymentValue||0),0),totalCurrent:d.reduce((l,j)=>l+(j.paymentValue||0),0),metricValue:d.reduce((l,j)=>l+(j.paymentValue||0),0),transactions:d.length,totalTransactions:d.length,uniqueMembers:new Set(d.map(l=>l.memberId||l.customerEmail)).size,totalCustomers:new Set(d.map(l=>l.memberId||l.customerEmail)).size,specificRevenue:d.reduce((l,j)=>l+(j.paymentValue||0),0),specificTransactions:d.length,specificCustomers:new Set(d.map(l=>l.memberId||l.customerEmail)).size,specificProducts:new Set(d.map(l=>l.cleanedProduct||l.paymentItem)).size,isDynamic:!0,calculatedFromFiltered:!0};V(M),H(g)},t=r=>{const d=i,g=d.reduce((L,K)=>L+(K.paymentValue||0),0),M=d.length,l=new Set(d.map(L=>L.memberId||L.customerEmail)).size,j={...r,rawData:d,filteredTransactionData:d,totalRevenue:g,grossRevenue:g,netRevenue:g,totalValue:g,totalCurrent:g,metricValue:g,transactions:M,totalTransactions:M,uniqueMembers:l,totalCustomers:l,specificRevenue:g,specificTransactions:M,specificCustomers:l,isDynamic:!0,calculatedFromFiltered:!0};V(j),H("metric")},h=r=>{const d=new Set(I);d.has(r)?d.delete(r):d.add(r),y(d)},N=()=>{const r=xe();w({dateRange:r,location:[],category:[],product:[],soldBy:[],paymentMethod:[]})};return e.jsxs("div",{className:"space-y-8",children:[e.jsx(es,{data:i}),e.jsx("div",{className:"container mx-auto px-6",children:e.jsx(ze,{})}),e.jsx("div",{className:"container mx-auto px-6 space-y-6",children:e.jsxs(se,{value:T,onValueChange:x,className:"w-full",children:[e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx(te,{className:"bg-white/90 backdrop-blur-sm p-2 rounded-2xl shadow-xl border-0 grid grid-cols-4 w-full max-w-7xl min-h-24 overflow-hidden",children:ue.map(r=>e.jsx(z,{value:r.id,className:"relative px-6 py-4 font-semibold text-gray-800 transition-all duration-300 ease-out hover:scale-105 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg hover:bg-gray-50 text-2xl rounded-2xl",children:e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsx("div",{className:"font-bold",children:r.name.split(",")[0]}),e.jsx("div",{className:"text-xs opacity-80",children:r.name.split(",")[1]?.trim()})]})},r.id))})}),ue.map(r=>e.jsxs(E,{value:r.id,className:"space-y-8",children:[e.jsx("div",{className:"w-full",children:e.jsx(Ee,{filters:s,onFiltersChange:w,onReset:N})}),e.jsx(_e,{data:i,onMetricClick:t}),e.jsx(Je,{data:p}),e.jsx($e,{data:i}),e.jsxs(se,{defaultValue:"monthOnMonth",className:"w-full",children:[e.jsxs(te,{className:"bg-white/90 backdrop-blur-sm p-2 rounded-2xl shadow-xl border-0 grid grid-cols-6 w-full max-w-6xl mx-auto overflow-hidden",children:[e.jsx(z,{value:"monthOnMonth",className:"relative rounded-xl px-4 py-3 font-semibold text-xs transition-all duration-300 ease-out hover:scale-105 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg hover:bg-gray-50",children:"Month-on-Month"}),e.jsx(z,{value:"yearOnYear",className:"relative rounded-xl px-4 py-3 font-semibold text-xs transition-all duration-300 ease-out hover:scale-105 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg hover:bg-gray-50",children:"Year-on-Year"}),e.jsx(z,{value:"productPerformance",className:"relative rounded-xl px-4 py-3 font-semibold text-xs transition-all duration-300 ease-out hover:scale-105 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg hover:bg-gray-50",children:"Product Performance"}),e.jsx(z,{value:"categoryPerformance",className:"relative rounded-xl px-4 py-3 font-semibold text-xs transition-all duration-300 ease-out hover:scale-105 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg hover:bg-gray-50",children:"Category Performance"}),e.jsx(z,{value:"soldByAnalysis",className:"relative rounded-xl px-4 py-3 font-semibold text-xs transition-all duration-300 ease-out hover:scale-105 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg hover:bg-gray-50",children:"Sold By Analysis"}),e.jsx(z,{value:"paymentMethodAnalysis",className:"relative rounded-xl px-4 py-3 font-semibold text-xs transition-all duration-300 ease-out hover:scale-105 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg hover:bg-gray-50",children:"Payment Methods"})]}),e.jsx(E,{value:"monthOnMonth",className:"mt-8",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Month-on-Month Analysis"}),e.jsx(He,{data:p,onRowClick:c,collapsedGroups:I,onGroupToggle:h,selectedMetric:D})]})}),e.jsx(E,{value:"yearOnYear",className:"mt-8",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Year-on-Year Analysis"}),e.jsx(Ye,{data:p,onRowClick:c,selectedMetric:D})]})}),e.jsx(E,{value:"productPerformance",className:"mt-8",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Product Performance Analysis"}),e.jsx(Xe,{data:p,onRowClick:c,selectedMetric:D})]})}),e.jsx(E,{value:"categoryPerformance",className:"mt-8",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Category Performance Analysis"}),e.jsx(Qe,{data:p,onRowClick:c,selectedMetric:D})]})}),e.jsx(E,{value:"soldByAnalysis",className:"mt-8",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Sold By Analysis"}),e.jsx(Ue,{data:p,onRowClick:c,selectedMetric:D})]})}),e.jsx(E,{value:"paymentMethodAnalysis",className:"mt-8",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Payment Method Analysis"}),e.jsx(Ke,{data:p,onRowClick:c,selectedMetric:D})]})})]})]},r.id))]})}),m&&e.jsx(We,{isOpen:!!m,onClose:()=>V(null),data:m,type:B})]})};export{os as S,cs as a};
