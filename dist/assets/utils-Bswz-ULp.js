import{r as D,bS as re}from"./react-vendor-CYideCN0.js";import{bt as oe,bu as ce}from"./vendor-BZGQbuwF.js";import{f as O}from"./utils-vendor-R2EFQ5ZT.js";import{u as ie}from"./dashboard-executive-DB_K8f8E.js";import{u as le}from"./dashboard-classes-DkM9eh--.js";const ue=1,de=1e6;let K=0;function me(){return K=(K+1)%Number.MAX_SAFE_INTEGER,K.toString()}const Y=new Map,J=a=>{if(Y.has(a))return;const s=setTimeout(()=>{Y.delete(a),k({type:"REMOVE_TOAST",toastId:a})},de);Y.set(a,s)},pe=(a,s)=>{switch(s.type){case"ADD_TOAST":return{...a,toasts:[s.toast,...a.toasts].slice(0,ue)};case"UPDATE_TOAST":return{...a,toasts:a.toasts.map(m=>m.id===s.toast.id?{...m,...s.toast}:m)};case"DISMISS_TOAST":{const{toastId:m}=s;return m?J(m):a.toasts.forEach(r=>{J(r.id)}),{...a,toasts:a.toasts.map(r=>r.id===m||m===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return s.toastId===void 0?{...a,toasts:[]}:{...a,toasts:a.toasts.filter(m=>m.id!==s.toastId)}}},z=[];let B={toasts:[]};function k(a){B=pe(B,a),z.forEach(s=>{s(B)})}function fe({...a}){const s=me(),m=I=>k({type:"UPDATE_TOAST",toast:{...I,id:s}}),r=()=>k({type:"DISMISS_TOAST",toastId:s});return k({type:"ADD_TOAST",toast:{...a,id:s,open:!0,onOpenChange:I=>{I||r()}}}),{id:s,dismiss:r,update:m}}function Ae(){const[a,s]=D.useState(B);return D.useEffect(()=>(z.push(s),()=>{const m=z.indexOf(s);m>-1&&z.splice(m,1)}),[a]),{...a,toast:fe,dismiss:m=>k({type:"DISMISS_TOAST",toastId:m})}}const ke=()=>{D.useEffect(()=>{const a=()=>{["/executive-summary","/sales-analytics","/funnel-leads","/client-retention","/trainer-performance"].forEach(r=>{const I=document.createElement("link");I.rel="prefetch",I.href=r,document.head.appendChild(I)})};if("requestIdleCallback"in window?requestIdleCallback(a):setTimeout(a,100),"PerformanceObserver"in window){const m=new PerformanceObserver(r=>{r.getEntries().forEach(I=>{I.entryType==="longtask"&&I.duration>100})});try{m.observe({entryTypes:["longtask"]})}catch{}}return(()=>{document.querySelectorAll('img[loading="lazy"]').forEach(r=>{if("IntersectionObserver"in window){const I=new IntersectionObserver(f=>{f.forEach(y=>{if(y.isIntersecting){const n=y.target;n.dataset.src&&(n.src=n.dataset.src,n.removeAttribute("data-src"),I.unobserve(n))}})});I.observe(r)}})})(),()=>{}},[])},xe=()=>{const a=new Date,s=new Date(a.getFullYear(),a.getMonth()-1,1),m=new Date(a.getFullYear(),a.getMonth(),0),r=f=>{const y=f.getFullYear(),n=String(f.getMonth()+1).padStart(2,"0"),p=String(f.getDate()).padStart(2,"0");return`${y}-${n}-${p}`};return{start:r(s),end:r(m)}},we=a=>{if(!a||a.trim()==="")return null;try{if(a.includes("/")){const r=a.split(" ")[0].trim().split("/");if(r.length===3){const I=parseInt(r[0]),f=parseInt(r[1]),y=parseInt(r[2]);if(!isNaN(y)&&!isNaN(f)&&!isNaN(I))return new Date(y,f-1,I)}}if(a.includes("-")){const m=new Date(a);if(!isNaN(m.getTime()))return m}const s=new Date(a);return isNaN(s.getTime())?null:s}catch{return null}},Le=()=>{const a=new Date,s=new Date(a.getFullYear(),a.getMonth()-1,1);return`${s.toLocaleDateString("en-US",{month:"long"})} ${s.getFullYear()}`},M={CLIENT_ID:"416630995185-007ermh3iidknbbtdmu5vct207mdlbaa.apps.googleusercontent.com",CLIENT_SECRET:"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",REFRESH_TOKEN:"1//04w4V2xMUIMzACgYIARAAGAQSNwF-L9Ir5__pXDmZVYaHKOSqyauTDVmTvrCvgaL2beep4gmp8_lVED0ppM9BPWDDimHyQKk50EY",TOKEN_URL:"https://oauth2.googleapis.com/token"},he="12xbYJQrh5wyYDaFhQrq4L0-YkSSlA6z7nMCb66XEbCQ",ne=()=>{const[a,s]=D.useState([]),[m,r]=D.useState(!0),[I,f]=D.useState(null),y=async()=>{try{return(await(await fetch(M.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:M.CLIENT_ID,client_secret:M.CLIENT_SECRET,refresh_token:M.REFRESH_TOKEN,grant_type:"refresh_token"})})).json()).access_token}catch(t){throw t}},n=t=>{if(typeof t=="number")return t;if(!t||t==="")return 0;const c=t.toString().replace(/,/g,""),g=parseFloat(c);return isNaN(g)?0:g},p=async()=>{try{r(!0),f(null);const t=await y(),c=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${he}/values/Sales?alt=json`,{headers:{Authorization:`Bearer ${t}`}});if(!c.ok)throw new Error("Failed to fetch data");const o=(await c.json()).values||[];if(o.length<2){s([]);return}const d=o[0],e=100,h=[],T=(b,i)=>{const N=o.slice(b,i).map(v=>{const u={};return d.forEach((x,w)=>{u[x]=v[w]||""}),{memberId:u["Member ID"]||u.memberId||"",customerName:u["Customer Name"]||u.customerName||"",customerEmail:u["Customer Email"]||u.customerEmail||"",saleItemId:u["Sale Item ID"]||u.saleItemId||"",paymentCategory:u["Payment Category"]||u.paymentCategory||"",membershipType:u["Membership Type"]||u.membershipType||"",paymentDate:u["Payment Date"]||u.paymentDate||"",paymentValue:n(u["Payment Value"]||u.paymentValue||0),paidInMoneyCredits:n(u["Paid in Money Credits"]||u["Paid In Money Credits"]||u.paidInMoneyCredits||0),paymentVAT:n(u["Payment VAT"]||u.paymentVAT||0),paymentItem:u["Payment Item"]||u.paymentItem||"",paymentStatus:u["Payment Status"]||u.paymentStatus||"",paymentMethod:u["Payment Method"]||u.paymentMethod||"",paymentTransactionId:u["Payment Transaction ID"]||u.paymentTransactionId||"",stripeToken:u["Stripe Token"]||u.stripeToken||"",soldBy:u["Sold By"]||u.soldBy||"",saleReference:u["Sale Reference"]||u.saleReference||"",calculatedLocation:u["Calculated Location"]||u.calculatedLocation||"",cleanedProduct:u["Cleaned Product"]||u.cleanedProduct||"",cleanedCategory:u["Cleaned Category"]||u.cleanedCategory||"",netRevenue:n(u["Payment Value"]||u.paymentValue||0)-n(u["Payment VAT"]||u.paymentVAT||0),vat:n(u["Payment VAT"]||u.paymentVAT||0),grossRevenue:n(u["Payment Value"]||u.paymentValue||0),mrpPreTax:n(u["Mrp - Pre Tax"]||u["MRP Pre Tax"]||u.MRP_Pre_Tax||u.mrpPreTax||u.MrpPreTax||u["Pre Tax MRP"]||0),mrpPostTax:n(u["Mrp - Post Tax"]||u["MRP Post Tax"]||u.MRP_Post_Tax||u.mrpPostTax||u.MrpPostTax||u["Post Tax MRP"]||0),discountAmount:n(u["Discount Amount -Mrp- Payment Value"]||u["Discount Amount"]||u.discount_amount||u.discountAmount||u.DiscountAmount||u.Discount_Amount||u["Total Discount"]||0),discountPercentage:n(u["Discount Percentage - discount amount/mrp*100"]||u["Discount Percentage"]||u.discount_percentage||u.discountPercentage||u.DiscountPercentage||u.Discount_Percentage||u["Discount %"]||u.Discount_Percent||0),hostId:u["Host Id"]||u["Host ID"]||u.hostId||""}});h.push(...N)},l=o.length-1;for(let b=1;b<=l;b+=e){const i=Math.min(b+e,l+1);b>1&&await new Promise(N=>setTimeout(N,0)),T(b,i)}s(h),f(null)}catch{f("Failed to load sales data")}finally{r(!1)}};return D.useEffect(()=>{p()},[]),{data:a,loading:m,error:I,refetch:p}},Oe={card:{shadow:"shadow-[0_4px_20px_rgba(0,0,0,0.08)]",border:"border border-slate-200/60",background:"bg-white/95 backdrop-blur-md",radius:"rounded-2xl"},table:{header:"bg-gradient-to-r from-slate-50 to-slate-100 border-b-2 border-slate-200",headerText:"text-xs font-bold text-slate-700 uppercase tracking-wider",row:"hover:bg-slate-50/80 transition-colors border-b border-slate-100",cell:"px-4 py-2 text-sm text-slate-800 font-medium whitespace-nowrap overflow-hidden text-ellipsis"}},R=a=>{if(a==null||isNaN(a))return"₹0";const s=Math.abs(a);return s<1e3?`₹${Math.round(a)}`:s>=1e7?`₹${(a/1e7).toFixed(1)}Cr`:s>=1e5?`₹${(a/1e5).toFixed(1)}L`:s>=1e3?`₹${(a/1e3).toFixed(1)}K`:`₹${a.toLocaleString("en-IN")}`},ee=a=>a==null||isNaN(a)?"0.0%":`${a.toFixed(1)}%`,_=a=>a==null||isNaN(a)?"0":a.toLocaleString("en-IN"),Me=()=>{const{data:a,loading:s,error:m}=ne();return{data:a,loading:s,error:m,isLoading:s}},F={CLIENT_ID:"416630995185-g7b0fm679lb4p45p5lou070cqscaalaf.apps.googleusercontent.com",CLIENT_SECRET:"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",REFRESH_TOKEN:"1//0gT2uoYBlNdGXCgYIARAAGBASNwF-L9IrBK_ijYwpce6-TdqDfji4GxYuc4uxIBKasdgoZBPm-tu_EU0xS34cNirqfLgXbJ8_NMk",TOKEN_URL:"https://oauth2.googleapis.com/token"},ge="149ILDqovzZA6FRUJKOwzutWdVqmqWBtWPfzG3A0zxTI",Fe=()=>{const[a,s]=D.useState([]),[m,r]=D.useState(!0),[I,f]=D.useState(null),y=async()=>{try{return(await(await fetch(F.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:F.CLIENT_ID,client_secret:F.CLIENT_SECRET,refresh_token:F.REFRESH_TOKEN,grant_type:"refresh_token"})})).json()).access_token}catch(t){throw t}},n=t=>{if(typeof t=="number")return t;if(!t||t==="")return 0;const c=t.toString().replace(/,/g,""),g=parseFloat(c);return isNaN(g)?0:g},p=async()=>{try{r(!0);const t=await y(),c=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${ge}/values/Sessions?alt=json`,{headers:{Authorization:`Bearer ${t}`}});if(!c.ok)throw new Error("Failed to fetch sessions data");const o=(await c.json()).values||[];if(o.length<2){s([]);return}const d=o.slice(1).map(e=>{const h=n(e[6]),T=n(e[7]),l=h>0?T/h*100:0;return{trainerId:e[0]||"",trainerFirstName:e[1]||"",trainerLastName:e[2]||"",trainerName:e[3]||"",sessionId:e[4]||"",sessionName:e[5]||"",capacity:h,checkedInCount:T,lateCancelledCount:n(e[8]),bookedCount:n(e[9]),complimentaryCount:n(e[10]),location:e[11]||"",date:e[12]||"",dayOfWeek:e[13]||"",time:e[14]||"",totalPaid:n(e[15]),nonPaidCount:n(e[16]),uniqueId1:e[17]||"",uniqueId2:e[18]||"",checkedInsWithMemberships:n(e[19]),checkedInsWithPackages:n(e[20]),checkedInsWithIntroOffers:n(e[21]),checkedInsWithSingleClasses:n(e[22]),classType:e[23]||"",cleanedClass:e[24]||"",classes:n(e[25]),fillPercentage:l,revenue:n(e[15]),uniqueId:e[17]||""}});s(d),f(null)}catch{f("Failed to load sessions data")}finally{r(!1)}};return D.useEffect(()=>{p()},[]),{data:a,loading:m,error:I,refetch:p}},V={CLIENT_ID:"416630995185-007ermh3iidknbbtdmu5vct207mdlbaa.apps.googleusercontent.com",CLIENT_SECRET:"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",REFRESH_TOKEN:"1//04pAfj5ZB3ahLCgYIARAAGAQSNwF-L9IrqCo4OyUjAbO1hP5bR3vhs8K96zDZkbeCzcuCjzEiBPZ3O639cLRkUduicMYK1Rzs5GY",TOKEN_URL:"https://oauth2.googleapis.com/token"},ye="149ILDqovzZA6FRUJKOwzutWdVqmqWBtWPfzG3A0zxTI",Ve=()=>{const[a,s]=D.useState([]),[m,r]=D.useState(!0),[I,f]=D.useState(null),y=async()=>{try{return(await(await fetch(V.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:V.CLIENT_ID,client_secret:V.CLIENT_SECRET,refresh_token:V.REFRESH_TOKEN,grant_type:"refresh_token"})})).json()).access_token}catch(t){throw t}},n=t=>{if(typeof t=="number")return t;if(!t||t==="")return 0;const c=t.toString().replace(/,/g,""),g=parseFloat(c);return isNaN(g)?0:g},p=async()=>{try{r(!0);const t=await y(),c=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${ye}/values/Payroll?alt=json`,{headers:{Authorization:`Bearer ${t}`}});if(!c.ok)throw new Error(`Failed to fetch payroll data: ${c.status} ${c.statusText}`);const o=(await c.json()).values||[];if(o.length<2){s([]);return}const d=o.slice(1).map(e=>({teacherId:e[0]||"",teacherName:e[1]||"",teacherEmail:e[2]||"",location:e[3]||"",cycleSessions:n(e[4]),emptyCycleSessions:n(e[5]),nonEmptyCycleSessions:n(e[6]),cycleCustomers:n(e[7]),cyclePaid:n(e[8]),strengthSessions:n(e[9]),emptyStrengthSessions:n(e[10]),nonEmptyStrengthSessions:n(e[11]),strengthCustomers:n(e[12]),strengthPaid:n(e[13]),barreSessions:n(e[14]),emptyBarreSessions:n(e[15]),nonEmptyBarreSessions:n(e[16]),barreCustomers:n(e[17]),barrePaid:n(e[18]),totalSessions:n(e[19]),totalEmptySessions:n(e[20]),totalNonEmptySessions:n(e[21]),totalCustomers:n(e[22]),totalPaid:n(e[23]),monthYear:e[24]||"",unique:e[25]||"",converted:n(e[26]),conversion:n(e[27]).toString()+"%",retained:n(e[28]),retention:n(e[29]).toString()+"%",new:n(e[30]),classAverageInclEmpty:n(e[22])>0?n(e[19])/n(e[22]):0,classAverageExclEmpty:n(e[21])>0?n(e[22])/n(e[21]):0}));s(d),f(null)}catch{f("Failed to load payroll data")}finally{r(!1)}};return D.useEffect(()=>{p()},[]),{data:a,isLoading:m,error:I,refetch:p}},$={CLIENT_ID:"416630995185-007ermh3iidknbbtdmu5vct207mdlbaa.apps.googleusercontent.com",CLIENT_SECRET:"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",REFRESH_TOKEN:"1//04pAfj5ZB3ahLCgYIARAAGAQSNwF-L9IrqCo4OyUjAbO1hP5bR3vhs8K96zDZkbeCzcuCjzEiBPZ3O639cLRkUduicMYK1Rzs5GY",TOKEN_URL:"https://oauth2.googleapis.com/token"},Te="149ILDqovzZA6FRUJKOwzutWdVqmqWBtWPfzG3A0zxTI",$e=()=>{const[a,s]=D.useState([]),[m,r]=D.useState(!0),[I,f]=D.useState(null),[y,n]=D.useState(!1),p=async()=>{try{return(await(await fetch($.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:$.CLIENT_ID,client_secret:$.CLIENT_SECRET,refresh_token:$.REFRESH_TOKEN,grant_type:"refresh_token"})})).json()).access_token}catch(o){throw o}},t=(o,d)=>{if(!o||!d)return 0;let e,h;if(o.includes("/")){const[b,i,N]=o.split(" ")[0].split("/");e=new Date(parseInt(N),parseInt(i)-1,parseInt(b))}else e=new Date(o);if(d.includes("/")){const[b,i,N]=d.split(" ")[0].split("/");h=new Date(parseInt(N),parseInt(i)-1,parseInt(b))}else h=new Date(d);if(isNaN(e.getTime())||isNaN(h.getTime()))return 0;const T=h.getTime()-e.getTime(),l=Math.ceil(T/(1e3*60*60*24));return Math.max(0,l)},c=(o="")=>{if(!o)return"";let d;if(o.includes("/")){const T=o.split(",")[0].trim(),[l,b,i]=T.split("/");d=new Date(parseInt(i),parseInt(b)-1,parseInt(l))}else d=new Date(o);if(isNaN(d.getTime()))return"";const e=d.getFullYear(),h=(d.getMonth()+1).toString().padStart(2,"0");return`${e}-${h}`},g=async()=>{try{y&&r(!0);const o=await p(),d=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${Te}/values/New?alt=json`,{headers:{Authorization:`Bearer ${o}`}});if(!d.ok)throw new Error("Failed to fetch new client data");const h=(await d.json()).values||[];if(h.length<2){s([]);return}const T=h.slice(1).map(l=>{const b=l[5]||"";return{memberId:l[0]||"",firstName:l[1]||"",lastName:l[2]||"",email:l[3]||"",phoneNumber:l[4]||"",firstVisitDate:b,firstVisitEntityName:l[6]||"",firstVisitType:l[7]||"",firstVisitLocation:l[8]||"",paymentMethod:l[9]||"",membershipUsed:l[10]||"",homeLocation:l[11]||"",classNo:parseFloat(l[12])||0,trainerName:l[13]||"",isNew:l[14]||"",visitsPostTrial:parseFloat(l[15])||0,membershipsBoughtPostTrial:l[16]||"",purchaseCountPostTrial:parseFloat(l[17])||0,ltv:parseFloat(l[18])||0,retentionStatus:l[19]||"",conversionStatus:l[20]||"",period:l[21]||"",unique:l[22]||"",firstPurchase:l[23]||"",conversionSpan:t(b,l[23]||""),monthYear:c(b)}});s(T),f(null),n(!0)}catch{f("Failed to load new client data"),n(!0)}finally{r(!1)}};return D.useEffect(()=>{y||g()},[y]),{data:a,loading:m,error:I,refetch:g}},G={CLIENT_ID:"416630995185-g7b0fm679lb4p45p5lou070cqscaalaf.apps.googleusercontent.com",CLIENT_SECRET:"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",REFRESH_TOKEN:"1//0gT2uoYBlNdGXCgYIARAAGBASNwF-L9IrBK_ijYwpce6-TdqDfji4GxYuc4uxIBKasdgoZBPm-tu_EU0xS34cNirqfLgXbJ8_NMk",TOKEN_URL:"https://oauth2.googleapis.com/token"},Ie="1dQMNF69WnXVQdhlLvUZTig3kL97NA21k6eZ9HRu6xiQ",A=a=>{if(!a||a.trim()===""||a==="-")return"";try{let s;const m=new Date;if(a.includes("/")){const r=a.split("/");if(r.length===3){const I=parseInt(r[0]),f=parseInt(r[1]),y=parseInt(r[2]);!isNaN(y)&&!isNaN(f)&&!isNaN(I)&&(s=new Date(y,f-1,I))}}else a.includes("-")?s=new Date(a):s=new Date(a);return!s||isNaN(s.getTime())||s>m||s.getFullYear()<2020?"":s.toISOString()}catch{return""}},E=(a,s)=>a&&a[s]!==void 0&&a[s]!==null?String(a[s]).trim():"",De=(a,s)=>{const m=E(a,s),r=parseFloat(m);return isNaN(r)?0:r},te=(a,s)=>{const m=E(a,s),r=parseInt(m);return isNaN(r)?0:r},Ge=()=>{const[a,s]=D.useState([]),[m,r]=D.useState(!0),[I,f]=D.useState(null),y=async()=>{try{const p=await fetch(G.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:G.CLIENT_ID,client_secret:G.CLIENT_SECRET,refresh_token:G.REFRESH_TOKEN,grant_type:"refresh_token"})});if(!p.ok)throw new Error(`Token request failed: ${p.statusText}`);const t=await p.json();if(!t.access_token)throw new Error("No access token received");return t.access_token}catch(p){throw p}},n=async()=>{try{r(!0),f(null);const p=await y(),t=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${Ie}/values/◉ Leads?alt=json`,{headers:{Authorization:`Bearer ${p}`}});if(!t.ok)throw new Error(`Failed to fetch leads data: ${t.statusText}`);const g=(await t.json()).values||[];if(g.length<2){s([]);return}const o=g.slice(1).map((d,e)=>{try{return!d||d.length===0?null:{id:E(d,0),fullName:E(d,1),phone:E(d,2),email:E(d,3),createdAt:A(E(d,4)),sourceId:E(d,5),source:E(d,6),memberId:E(d,7),convertedToCustomerAt:A(E(d,8)),stage:E(d,9),associate:E(d,10),remarks:E(d,11),followUp1Date:A(E(d,12)),followUpComments1:E(d,13),followUp2Date:A(E(d,14)),followUpComments2:E(d,15),followUp3Date:A(E(d,16)),followUpComments3:E(d,17),followUp4Date:A(E(d,18)),followUpComments4:E(d,19),center:E(d,20),classType:E(d,21),hostId:E(d,22),status:E(d,23),channel:E(d,24),period:E(d,25),purchasesMade:te(d,26),ltv:De(d,27),visits:te(d,28),trialStatus:E(d,29),conversionStatus:E(d,30),retentionStatus:E(d,31)}}catch{return null}}).filter(d=>d!==null);s(o),f(null)}catch(p){f(p instanceof Error?p.message:"Failed to load leads data")}finally{r(!1)}};return D.useEffect(()=>{n()},[]),{data:a,loading:m,error:I,refetch:n}},Ue=()=>{const{data:a,loading:s,error:m}=ne(),[r,I]=D.useState([]);D.useEffect(()=>{if(a&&a.length>0)try{const y=t=>{if(t==null||t==="")return 0;const c=t.toString().replace(/[₹,]/g,"").trim(),g=parseFloat(c);return isNaN(g)?0:g},n=t=>{if(!t)return"";try{if(t.includes("/")){const c=t.split(",")[0].trim(),[g,o,d]=c.split("/");if(g&&o&&d){const e=`${d}-${o.padStart(2,"0")}-${g.padStart(2,"0")}`;return new Date(e).toISOString().split("T")[0]}}if(t.includes("-")){const c=new Date(t);if(!isNaN(c.getTime()))return c.toISOString().split("T")[0]}return""}catch{return""}},p=a.map(t=>{const c=y(t.discountAmount||t["Discount Amount -Mrp- Payment Value"]||0),g=y(t.discountPercentage||t["Discount Percentage - discount amount/mrp*100"]||0);return{memberId:t.memberId||t["Member ID"]?.toString()||"",customerName:t.customerName||t["Customer Name"]||"",customerEmail:t.customerEmail||t["Customer Email"]||"",saleItemId:t.saleItemId||t["Sale Item ID"]?.toString()||"",paymentCategory:t.paymentCategory||t["Payment Category"]||"",paymentDate:n(t.paymentDate||t["Payment Date"]||""),paymentValue:y(t.paymentValue||t["Payment Value"]||0),paidInMoneyCredits:y(t.paidInMoneyCredits||t["Paid In Money Credits"]||0),paymentVat:y(t.paymentVat||t["Payment VAT"]||0),paymentItem:t.paymentItem||t["Payment Item"]||"",paymentMethod:t.paymentMethod||t["Payment Method"]||"",paymentStatus:t.paymentStatus||t["Payment Status"]||"",paymentTransactionId:t.paymentTransactionId||t["Payment Transaction ID"]?.toString()||"",stripeToken:t.stripeToken||t["Stripe Token"]||"",saleReference:t.saleReference||t["Sale Reference"]?.toString()||"",soldBy:t.soldBy==="-"?"Online/System":t.soldBy||t["Sold By"]||"Unknown",location:t.calculatedLocation||t["Calculated Location"]||"",cleanedProduct:t.cleanedProduct||t["Cleaned Product"]||"",cleanedCategory:t.cleanedCategory||t["Cleaned Category"]||"",hostId:t.hostId||t["Host Id"]?.toString()||"",mrpPreTax:y(t.mrpPreTax||t["Mrp - Pre Tax"]||0),mrpPostTax:y(t.mrpPostTax||t["Mrp - Post Tax"]||0),discountAmount:c,discountPercentage:g,membershipType:t.membershipType||t["Membership Type"]?.trim()||""}});I(p)}catch{I([])}else I([])},[a]);const f=D.useMemo(()=>{if(!r.length)return{totalDiscountAmount:0,totalRevenueLost:0,totalTransactions:0,avgDiscountPercentage:0,totalPotentialRevenue:0,totalActualRevenue:0,discountEffectiveness:0,productBreakdown:[],monthlyBreakdown:[]};const y=r.reduce((e,h)=>e+(h.discountAmount||0),0),n=r.length,p=r.reduce((e,h)=>e+(h.mrpPostTax||h.paymentValue||0),0),t=r.reduce((e,h)=>e+(h.paymentValue||0),0),c=r.filter(e=>(e.discountAmount||0)>0),g=c.length>0?c.reduce((e,h)=>e+(h.discountPercentage||0),0)/c.length:0,o=r.reduce((e,h)=>{const T=h.cleanedProduct||"Unknown Product";return e[T]||(e[T]={product:T,transactions:0,totalDiscount:0,avgDiscountPercentage:0,revenue:0,totalMrp:0}),e[T].transactions+=1,e[T].totalDiscount+=h.discountAmount||0,e[T].revenue+=h.paymentValue||0,e[T].totalMrp+=h.mrpPostTax||h.paymentValue||0,e},{});Object.values(o).forEach(e=>{e.avgDiscountPercentage=e.totalMrp>0?e.totalDiscount/e.totalMrp*100:0});const d=r.reduce((e,h)=>{if(!h.paymentDate)return e;const T=h.paymentDate.substring(0,7);return e[T]||(e[T]={month:T,transactions:0,totalDiscount:0,revenue:0}),e[T].transactions+=1,e[T].totalDiscount+=h.discountAmount||0,e[T].revenue+=h.paymentValue||0,e},{});return{totalDiscountAmount:y,totalRevenueLost:y,totalTransactions:n,avgDiscountPercentage:g,totalPotentialRevenue:p,totalActualRevenue:t,discountEffectiveness:p>0?t/p*100:0,productBreakdown:Object.values(o),monthlyBreakdown:Object.values(d)}},[r]);return{data:r,metrics:f,loading:s,error:m}},je=()=>{const[a,s]=D.useState(!1),m=(n,p)=>[p.join(","),...n.map(c=>p.map(g=>{const o=c[g];return o==null?"":typeof o=="string"&&o.includes(",")?`"${o.replace(/"/g,'""')}"`:o}).join(","))].join(`
`),r=(n,p)=>{const t=new Blob([n],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a"),g=URL.createObjectURL(t);c.setAttribute("href",g),c.setAttribute("download",p),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)},I=(n,p)=>{const t=new oe("l","mm","a4"),c=t.internal.pageSize.getWidth();t.internal.pageSize.getHeight(),t.setFontSize(20),t.setTextColor(40,40,40),t.text("Complete Dashboard Export",c/2,20,{align:"center"}),t.setFontSize(10),t.setTextColor(100,100,100);const g=O(new Date,"PPP p");t.text(`Generated on: ${g}`,20,30),p.dateRange&&t.text(`Date Range: ${O(new Date(p.dateRange.start),"PP")} - ${O(new Date(p.dateRange.end),"PP")}`,20,35);let o=45;return n.salesData&&n.salesData.length>0&&(o=f(t,"Sales Analytics Data",n.salesData,o,["customerName","paymentDate","membershipType","paymentValue","calculatedLocation","soldBy","paymentMethod"])),n.sessionsData&&n.sessionsData.length>0&&(o=f(t,"Sessions Data",n.sessionsData,o,["date","classType","instructor","location","capacity","checkedIn","fillPercentage"])),n.newClientData&&n.newClientData.length>0&&(o=f(t,"Client Conversion Data",n.newClientData,o,["firstName","lastName","email","firstVisitDate","firstVisitLocation","conversionStatus","ltv"])),n.payrollData&&n.payrollData.length>0&&(o=f(t,"Trainer Performance Data",n.payrollData,o,["teacherName","location","totalSessions","totalCustomers","totalPaid","conversion","retention"])),n.lateCancellationsData&&n.lateCancellationsData.length>0&&(o=f(t,"Late Cancellations Data",n.lateCancellationsData,o,["firstName","lastName","sessionName","teacherName","location","dateIST","time"])),n.discountData&&n.discountData.length>0&&(o=f(t,"Discounts & Promotions Data",n.discountData,o,["firstName","lastName","cleanedProduct","mrpPostTax","discountAmount","discountPercentage","location"])),n.additionalData&&Object.entries(n.additionalData).forEach(([d,e])=>{if(e&&e.length>0){const h=Object.keys(e[0]).slice(0,7);o=f(t,d,e,o,h)}}),t},f=(n,p,t,c,g)=>{const o=n.internal.pageSize.getHeight();c>o-100&&(n.addPage(),c=20),n.setFontSize(14),n.setTextColor(60,60,60),n.text(p,20,c),c+=10;const d=t.slice(0,100).map(e=>g.map(h=>{const T=e[h];return T==null?"":typeof T=="number"?T.toLocaleString():String(T)}));return n.autoTable({head:[g.map(e=>e.charAt(0).toUpperCase()+e.slice(1).replace(/([A-Z])/g," $1"))],body:d,startY:c,styles:{fontSize:8,cellPadding:2},headStyles:{fillColor:[66,139,202],textColor:255,fontSize:9,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:20,right:20}}),n.lastAutoTable.finalY+15};return{exportAllData:async(n,p)=>{s(!0);try{const t=p.fileName||`dashboard-export-${O(new Date,"yyyy-MM-dd-HH-mm")}`;if(p.format==="pdf")I(n,p).save(`${t}.pdf`);else if(p.format==="csv"){let c="";const g=[];if(n.salesData?.length){const o=Object.keys(n.salesData[0]);c+=`Sales Analytics Data
${m(n.salesData,o)}

`,g.push("Sales")}if(n.sessionsData?.length){const o=Object.keys(n.sessionsData[0]);c+=`Sessions Data
${m(n.sessionsData,o)}

`,g.push("Sessions")}if(n.newClientData?.length){const o=Object.keys(n.newClientData[0]);c+=`Client Conversion Data
${m(n.newClientData,o)}

`,g.push("Client Conversion")}if(n.payrollData?.length){const o=Object.keys(n.payrollData[0]);c+=`Trainer Performance Data
${m(n.payrollData,o)}

`,g.push("Trainer Performance")}if(n.lateCancellationsData?.length){const o=Object.keys(n.lateCancellationsData[0]);c+=`Late Cancellations Data
${m(n.lateCancellationsData,o)}

`,g.push("Late Cancellations")}if(n.discountData?.length){const o=Object.keys(n.discountData[0]);c+=`Discounts & Promotions Data
${m(n.discountData,o)}

`,g.push("Discounts")}n.additionalData&&Object.entries(n.additionalData).forEach(([o,d])=>{if(d?.length){const e=Object.keys(d[0]);c+=`${o}
${m(d,e)}

`,g.push(o)}}),r(c,`${t}.csv`)}}catch(t){throw t}finally{s(!1)}},isExporting:a}},ze=a=>{const{filters:s}=ie();return{metrics:D.useMemo(()=>{if(!a||a.length===0)return[];const r=a,I=a.length,f=Math.floor(I/2),y=r.slice(0,f);r.slice(f);const n=r.reduce((S,C)=>S+(typeof C.paymentValue=="number"?C.paymentValue:0),0),p=r.reduce((S,C)=>S+(typeof C.discountAmount=="number"?C.discountAmount:0),0),t=r.length,c=new Set(r.map(S=>S.memberId||S.customerEmail).filter(Boolean)).size,g=r.length,o=t>0?n/t:0,d=c>0?n/c:0,e=r.length>0?r.reduce((S,C)=>S+(typeof C.discountPercentage=="number"?C.discountPercentage:0),0)/r.length:0,h=y.reduce((S,C)=>S+(typeof C.paymentValue=="number"?C.paymentValue:0),0),T=y.reduce((S,C)=>S+(typeof C.discountAmount=="number"?C.discountAmount:0),0),l=y.length,b=new Set(y.map(S=>S.memberId||S.customerEmail).filter(Boolean)).size,i=y.length,N=l>0?h/l:0,v=b>0?h/b:0,u=y.length>0?y.reduce((S,C)=>S+(typeof C.discountPercentage=="number"?C.discountPercentage:0),0)/y.length:0,P=(S,C)=>{if(C===0)return{rate:S>0?100:0,isSignificant:S>0,trend:"moderate"};const L=(S-C)/C*100,ae=Math.abs(L)>=5,se=Math.abs(L)>=20?"strong":Math.abs(L)>=10?"moderate":"weak";return{rate:L,isSignificant:ae,trend:se}},x=P(n,h),w=P(t,l),q=P(c,b),H=P(g,i),W=P(o,N),Q=P(d,v),Z=P(p,T),X=P(e,u);return[{title:"Sales Revenue",value:R(n),rawValue:n,change:x.rate,changeDetails:x,icon:"DollarSign",color:"blue",description:"Total sales revenue across all transactions",previousValue:R(h),previousRawValue:h,comparison:{current:n,previous:h,difference:n-h}},{title:"Units Sold",value:_(g),rawValue:g,change:H.rate,changeDetails:H,icon:"ShoppingCart",color:"green",description:"Total number of units/items sold",previousValue:_(i),previousRawValue:i,comparison:{current:g,previous:i,difference:g-i}},{title:"Transactions",value:_(t),rawValue:t,change:w.rate,changeDetails:w,icon:"Activity",color:"purple",description:"Number of completed transactions",previousValue:_(l),previousRawValue:l,comparison:{current:t,previous:l,difference:t-l}},{title:"Unique Members",value:_(c),rawValue:c,change:q.rate,changeDetails:q,icon:"Users",color:"orange",description:"Individual customers who made purchases",previousValue:_(b),previousRawValue:b,comparison:{current:c,previous:b,difference:c-b}},{title:"Avg Transaction Value",value:R(o),rawValue:o,change:W.rate,changeDetails:W,icon:"Target",color:"cyan",description:"Average value per transaction",previousValue:R(N),previousRawValue:N,comparison:{current:o,previous:N,difference:o-N}},{title:"Avg Spend per Member",value:R(d),rawValue:d,change:Q.rate,changeDetails:Q,icon:"Calendar",color:"pink",description:"Average spending per unique customer",previousValue:R(v),previousRawValue:v,comparison:{current:d,previous:v,difference:d-v}},{title:"Discount Value",value:R(p),rawValue:p,change:Z.rate,changeDetails:Z,icon:"CreditCard",color:"red",description:"Total discount amount applied",previousValue:R(T),previousRawValue:T,comparison:{current:p,previous:T,difference:p-T}},{title:"Discount Percentage",value:ee(e/100),rawValue:e,change:X.rate,changeDetails:X,icon:"ArrowDownRight",color:"amber",description:"Average discount rate applied",previousValue:ee(u/100),previousRawValue:u,comparison:{current:e,previous:u,difference:e-u}}]},[a,s.dateRange])}},Be=re()(ce((a,s)=>({isLoading:!1,loadingMessage:"Loading...",progress:0,loadingStartTime:null,setLoading:(m,r="Loading...")=>{a({isLoading:m,loadingMessage:r,loadingStartTime:m?Date.now():null,progress:m?0:100})},setProgress:m=>a({progress:Math.min(Math.max(m,0),100)}),resetProgress:()=>a({progress:0})}))),Ke=a=>{let s=null;try{s=le().filters}catch{s=null}return D.useMemo(()=>a?a.filter(r=>{const I=r.sessionName?.toLowerCase()||"";if(I.includes("test")||I.includes("demo"))return!1;if(!s)return!0;if(s.trainers.length>0&&!s.trainers.includes(r.trainerName)||s.classTypes.length>0&&!s.classTypes.includes(r.cleanedClass)||s.dayOfWeek.length>0&&!s.dayOfWeek.includes(r.dayOfWeek)||s.timeSlots.length>0&&!s.timeSlots.includes(r.time))return!1;if(s.dateRange.start||s.dateRange.end){let f;if(r.date.includes("/")){const n=r.date.split("/");if(n.length===3){const p=parseInt(n[0]),t=parseInt(n[1]),c=parseInt(n[2]);f=new Date(c,t-1,p)}else f=new Date(r.date)}else f=new Date(r.date);if(isNaN(f.getTime()))return!0;const y=new Date(f.getFullYear(),f.getMonth(),f.getDate());if(s.dateRange.start){const n=new Date(s.dateRange.start.getFullYear(),s.dateRange.start.getMonth(),s.dateRange.start.getDate());if(y<n)return!1}if(s.dateRange.end){const n=new Date(s.dateRange.end.getFullYear(),s.dateRange.end.getMonth(),s.dateRange.end.getDate());if(y>n)return!1}}return!0}):[],[a,s])},Ee={tabColors:{sales:{primary:"blue",gradients:{light:"from-blue-50/30 to-cyan-50/30",medium:"from-blue-100/50 to-cyan-100/50",dark:"from-blue-600 to-blue-700",accent:"from-blue-500 to-cyan-600",border:"border-blue-200/50",text:"text-blue-700",bg:"bg-blue-50"},border:"border-blue-200/50",text:"text-blue-700",bg:"bg-blue-50"},retention:{primary:"green",gradients:{light:"from-green-50/30 to-emerald-50/30",medium:"from-green-100/50 to-emerald-100/50",dark:"from-green-600 to-green-700",accent:"from-green-500 to-emerald-600",border:"border-green-200/50",text:"text-green-700",bg:"bg-green-50"},border:"border-green-200/50",text:"text-green-700",bg:"bg-green-50"},attendance:{primary:"purple",gradients:{light:"from-purple-50/30 to-violet-50/30",medium:"from-purple-100/50 to-violet-100/50",dark:"from-purple-600 to-purple-700",accent:"from-purple-500 to-violet-600",border:"border-purple-200/50",text:"text-purple-700",bg:"bg-purple-50"},border:"border-purple-200/50",text:"text-purple-700",bg:"bg-purple-50"},funnel:{primary:"red",gradients:{light:"from-red-50/30 to-orange-50/30",medium:"from-red-100/50 to-orange-100/50",dark:"from-red-600 to-red-700",accent:"from-red-500 to-orange-600",border:"border-red-200/50",text:"text-red-700",bg:"bg-red-50"},border:"border-red-200/50",text:"text-red-700",bg:"bg-red-50"},discounts:{primary:"orange",gradients:{light:"from-orange-50/30 to-amber-50/30",medium:"from-orange-100/50 to-amber-100/50",dark:"from-orange-600 to-orange-700",accent:"from-orange-500 to-amber-600",border:"border-orange-200/50",text:"text-orange-700",bg:"bg-orange-50"},border:"border-orange-200/50",text:"text-orange-700",bg:"bg-orange-50"}},components:{metricCard:{base:"bg-white backdrop-blur-sm shadow-xl border-0 overflow-hidden group hover:shadow-2xl transition-all duration-300",header:"p-6 pb-4",content:"p-6 pt-0",iconContainer:"p-3 rounded-xl shadow-lg",titleClass:"text-lg font-semibold text-gray-900",descriptionClass:"text-sm text-gray-600"},hero:{container:"relative min-h-[400px] overflow-hidden",content:"relative z-10 flex flex-col items-center justify-center text-center p-8",title:"text-4xl md:text-6xl font-bold text-white mb-4",subtitle:"text-xl md:text-2xl text-white/90 mb-8",floatingElement:"absolute opacity-20 animate-pulse"}},formatters:{currency:a=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:1}).format(a),number:a=>new Intl.NumberFormat("en-IN",{maximumFractionDigits:1}).format(a),percentage:a=>`${a.toFixed(1)}%`,compact:a=>a>=1e6?`${(a/1e6).toFixed(1)}M`:a>=1e3?`${(a/1e3).toFixed(1)}K`:a.toFixed(1)}},Ye=a=>Ee.tabColors[a],U={CLIENT_ID:"416630995185-007ermh3iidknbbtdmu5vct207mdlbaa.apps.googleusercontent.com",CLIENT_SECRET:"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",REFRESH_TOKEN:"1//04w4V2xMUIMzACgYIARAAGAQSNwF-L9Ir5__pXDmZVYaHKOSqyauTDVmTvrCvgaL2beep4gmp8_lVED0ppM9BPWDDimHyQKk50EY",TOKEN_URL:"https://oauth2.googleapis.com/token"},be="1rGMDDvvTbZfNg1dueWtRN3LhOgGQOdLg3Fd7Sn1GCZo",qe=()=>{const[a,s]=D.useState([]),[m,r]=D.useState(!0),[I,f]=D.useState(null),y=async()=>{try{return(await(await fetch(U.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:U.CLIENT_ID,client_secret:U.CLIENT_SECRET,refresh_token:U.REFRESH_TOKEN,grant_type:"refresh_token"})})).json()).access_token}catch(p){throw p}},n=async()=>{try{r(!0),f(null);const p=await y(),t=["Expirations","Expiration","Members","Sheet1","Data"];let c,g="";for(const T of t)try{if(c=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${be}/values/${T}?alt=json`,{headers:{Authorization:`Bearer ${p}`}}),c.ok){g=T;break}}catch{continue}if(!c||!c.ok)throw new Error(`Failed to fetch expirations data from any sheet. Tried: ${t.join(", ")}`);const d=(await c.json()).values||[];if(d.length<2){s([]);return}const e=d[0],h=[];for(let T=1;T<d.length;T++){const l=d[T];if(!l||l.length===0)continue;const b={uniqueId:l[e.findIndex(i=>i==="Unique Id")]||`exp-${Date.now()}-${T}`,memberId:l[e.findIndex(i=>i==="Member ID")]||"",firstName:l[e.findIndex(i=>i==="First Name")]||"",lastName:l[e.findIndex(i=>i==="Last Name")]||"",email:l[e.findIndex(i=>i==="Email")]||"",membershipName:l[e.findIndex(i=>i==="Membership Name")]||"",endDate:l[e.findIndex(i=>i==="End Date")]||"",homeLocation:l[e.findIndex(i=>i==="Home Location")]||"",currentUsage:l[e.findIndex(i=>i==="Current Usage")]||"",id:l[e.findIndex(i=>i==="Id")]||"",orderAt:l[e.findIndex(i=>i==="Order At")]||"",soldBy:l[e.findIndex(i=>i==="Sold By")]||"",membershipId:l[e.findIndex(i=>i==="Membership Id")]||"",frozen:l[e.findIndex(i=>i==="Frozen")]==="TRUE",paid:l[e.findIndex(i=>i==="Paid")]||"",status:l[e.findIndex(i=>i==="Status")]||""};h.push(b)}s(h),f(null)}catch(p){f(p instanceof Error?p.message:"Failed to load expirations data"),s([])}finally{r(!1)}};return D.useEffect(()=>{n()},[]),{data:a,loading:m,error:I||"",refetch:n}},j={CLIENT_ID:"416630995185-007ermh3iidknbbtdmu5vct207mdlbaa.apps.googleusercontent.com",CLIENT_SECRET:"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",REFRESH_TOKEN:"1//04w4V2xMUIMzACgYIARAAGAQSNwF-L9Ir5__pXDmZVYaHKOSqyauTDVmTvrCvgaL2beep4gmp8_lVED0ppM9BPWDDimHyQKk50EY",TOKEN_URL:"https://oauth2.googleapis.com/token"},Se="149ILDqovzZA6FRUJKOwzutWdVqmqWBtWPfzG3A0zxTI",He=()=>{const[a,s]=D.useState([]),[m,r]=D.useState(!0),[I,f]=D.useState(null),y=async()=>{try{return(await(await fetch(j.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:j.CLIENT_ID,client_secret:j.CLIENT_SECRET,refresh_token:j.REFRESH_TOKEN,grant_type:"refresh_token"})})).json()).access_token}catch(t){throw t}},n=t=>{if(typeof t=="number")return t;if(!t||t==="")return 0;const c=t.toString();if(c.includes("-")&&(c.includes("1899")||c.includes("1900")))return 0;const g=c.replace(/,/g,""),o=parseFloat(g);return isNaN(o)?0:o},p=async()=>{try{r(!0),f(null);const t=await y(),c=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${Se}/values/Checkins?alt=json`,{headers:{Authorization:`Bearer ${t}`}});if(!c.ok)throw new Error("Failed to fetch late cancellations data");const o=(await c.json()).values||[];if(o.length<2){s([]);return}const d=[];if(o.length<2){s([]);return}const e=o[0],h=e.findIndex(T=>T==="Is Late Cancelled");if(h===-1){s([]);return}for(let T=1;T<o.length;T++){const l=o[T];if(!l||l.length===0||l[h]!=="TRUE")continue;const b={memberId:l[e.findIndex(i=>i==="Member ID")]||"",firstName:l[e.findIndex(i=>i==="First Name")]||"",lastName:l[e.findIndex(i=>i==="Last Name")]||"",email:l[e.findIndex(i=>i==="Email")]||"",location:l[e.findIndex(i=>i==="Location")]||"",sessionName:l[e.findIndex(i=>i==="Session Name")]||"",teacherName:l[e.findIndex(i=>i==="Teacher Name")]||"",cleanedProduct:l[e.findIndex(i=>i==="Cleaned Product")]||"",cleanedCategory:l[e.findIndex(i=>i==="Cleaned Category")]||"",cleanedClass:l[e.findIndex(i=>i==="Cleaned Class")]||"",paymentMethodName:l[e.findIndex(i=>i==="Payment Method Name")]||"",dateIST:l[e.findIndex(i=>i==="Date (IST)")]||"",dayOfWeek:l[e.findIndex(i=>i==="Day of Week")]||"",time:l[e.findIndex(i=>i==="Time")]||"",duration:n(l[e.findIndex(i=>i==="Duration (Minutes)")]||"0"),capacity:n(l[e.findIndex(i=>i==="Capacity")]||"0"),month:l[e.findIndex(i=>i==="Month")]||"",year:n(l[e.findIndex(i=>i==="Year")]||"0"),paidAmount:n(l[e.findIndex(i=>i==="Paid")]||"0"),isNew:l[e.findIndex(i=>i==="Is New")]||"",tableType:"checkins"};d.push(b)}s(d),f(null)}catch{f("Failed to load late cancellations data"),s([])}finally{r(!1)}};return D.useEffect(()=>{p()},[]),{data:a,loading:m,error:I,refetch:p}};export{Ee as D,ee as a,_ as b,Ke as c,Ve as d,Oe as e,R as f,xe as g,Le as h,Me as i,$e as j,Ge as k,Ue as l,ze as m,ne as n,Be as o,we as p,qe as q,He as r,Ae as s,je as t,Fe as u,Ye as v,ke as w};
