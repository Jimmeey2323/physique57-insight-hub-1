import{r as I,bR as ce}from"./react-vendor-Di6K3Iht.js";import{bt as ie,bu as le}from"./vendor-BIBqxFVC.js";import{f as M}from"./utils-vendor-R2EFQ5ZT.js";import{u as de}from"./dashboard-executive--OCmLWuN.js";import{u as ue}from"./dashboard-classes-DXdXVLRz.js";const me=1,pe=1e6;let H=0;function fe(){return H=(H+1)%Number.MAX_SAFE_INTEGER,H.toString()}const K=new Map,J=n=>{if(K.has(n))return;const s=setTimeout(()=>{K.delete(n),A({type:"REMOVE_TOAST",toastId:n})},pe);K.set(n,s)},he=(n,s)=>{switch(s.type){case"ADD_TOAST":return{...n,toasts:[s.toast,...n.toasts].slice(0,me)};case"UPDATE_TOAST":return{...n,toasts:n.toasts.map(m=>m.id===s.toast.id?{...m,...s.toast}:m)};case"DISMISS_TOAST":{const{toastId:m}=s;return m?J(m):n.toasts.forEach(r=>{J(r.id)}),{...n,toasts:n.toasts.map(r=>r.id===m||m===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return s.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(m=>m.id!==s.toastId)}}},z=[];let j={toasts:[]};function A(n){j=he(j,n),z.forEach(s=>{s(j)})}function ge({...n}){const s=fe(),m=D=>A({type:"UPDATE_TOAST",toast:{...D,id:s}}),r=()=>A({type:"DISMISS_TOAST",toastId:s});return A({type:"ADD_TOAST",toast:{...n,id:s,open:!0,onOpenChange:D=>{D||r()}}}),{id:s,dismiss:r,update:m}}function Ae(){const[n,s]=I.useState(j);return I.useEffect(()=>(z.push(s),()=>{const m=z.indexOf(s);m>-1&&z.splice(m,1)}),[n]),{...n,toast:ge,dismiss:m=>A({type:"DISMISS_TOAST",toastId:m})}}const ee={sales:{name:"Sales Analytics",heroGradient:"from-slate-900 via-blue-900 to-slate-800",activeTabGradient:"from-blue-600 to-blue-800",accentColors:{primary:"blue-600",secondary:"blue-500",light:"blue-100",dark:"blue-800"},metricCardBorder:"border-blue-200",tableHeaderGradient:"from-blue-700 to-blue-900",badgeColors:"bg-blue-100 text-blue-800"},discounts:{name:"Discounts & Promotions",heroGradient:"from-stone-900 via-amber-900 to-stone-800",activeTabGradient:"from-orange-600 to-amber-600",accentColors:{primary:"orange-600",secondary:"amber-500",light:"orange-100",dark:"orange-800"},metricCardBorder:"border-orange-200",tableHeaderGradient:"from-orange-700 to-amber-800",badgeColors:"bg-orange-100 text-orange-800"},funnel:{name:"Lead Funnel",heroGradient:"from-slate-900 via-violet-900 to-slate-800",activeTabGradient:"from-red-600 to-rose-700",accentColors:{primary:"red-600",secondary:"rose-500",light:"red-100",dark:"red-800"},metricCardBorder:"border-red-200",tableHeaderGradient:"from-red-700 to-rose-800",badgeColors:"bg-red-100 text-red-800"},retention:{name:"Client Retention",heroGradient:"from-gray-900 via-purple-900 to-gray-800",activeTabGradient:"from-purple-600 to-violet-700",accentColors:{primary:"purple-600",secondary:"violet-500",light:"purple-100",dark:"purple-800"},metricCardBorder:"border-purple-200",tableHeaderGradient:"from-purple-700 to-violet-800",badgeColors:"bg-purple-100 text-purple-800"},attendance:{name:"Class Attendance",heroGradient:"from-gray-900 via-purple-900 to-gray-800",activeTabGradient:"from-purple-600 to-violet-700",accentColors:{primary:"purple-600",secondary:"violet-500",light:"purple-100",dark:"purple-800"},metricCardBorder:"border-purple-200",tableHeaderGradient:"from-purple-700 to-violet-800",badgeColors:"bg-purple-100 text-purple-800"},powercycle:{name:"PowerCycle vs Barre",heroGradient:"from-zinc-900 via-cyan-900 to-zinc-800",activeTabGradient:"from-cyan-600 to-teal-700",accentColors:{primary:"cyan-600",secondary:"teal-500",light:"cyan-100",dark:"cyan-800"},metricCardBorder:"border-cyan-200",tableHeaderGradient:"from-cyan-700 to-teal-800",badgeColors:"bg-cyan-100 text-cyan-800"},expiration:{name:"Expiration Analytics",heroGradient:"from-neutral-900 via-red-900 to-neutral-800",activeTabGradient:"from-red-600 to-pink-700",accentColors:{primary:"red-600",secondary:"pink-500",light:"red-100",dark:"red-800"},metricCardBorder:"border-red-200",tableHeaderGradient:"from-red-700 to-pink-800",badgeColors:"bg-red-100 text-red-800"},cancellations:{name:"Late Cancellations",heroGradient:"from-stone-900 via-rose-900 to-stone-800",activeTabGradient:"from-rose-600 to-pink-700",accentColors:{primary:"rose-600",secondary:"pink-500",light:"rose-100",dark:"rose-800"},metricCardBorder:"border-rose-200",tableHeaderGradient:"from-rose-700 to-pink-800",badgeColors:"bg-rose-100 text-rose-800"},analytics:{name:"Analytics & Performance",heroGradient:"from-zinc-900 via-indigo-900 to-zinc-800",activeTabGradient:"from-indigo-600 to-indigo-800",accentColors:{primary:"indigo-600",secondary:"indigo-500",light:"indigo-100",dark:"indigo-800"},metricCardBorder:"border-indigo-200",tableHeaderGradient:"from-indigo-700 to-indigo-800",badgeColors:"bg-indigo-100 text-indigo-800"},summary:{name:"Executive Summary",heroGradient:"from-slate-900 via-teal-900 to-slate-800",activeTabGradient:"from-blue-600 to-purple-600",accentColors:{primary:"blue-600",secondary:"purple-500",light:"blue-100",dark:"blue-800"},metricCardBorder:"border-blue-200",tableHeaderGradient:"from-blue-700 to-purple-800",badgeColors:"bg-blue-100 text-blue-800"}},ne=n=>ee[n]||ee.summary,we=n=>`data-[state=active]:bg-gradient-to-r data-[state=active]:${ne(n).activeTabGradient} data-[state=active]:text-white data-[state=active]:shadow-lg`,Le=n=>`bg-gradient-to-r ${ne(n).tableHeaderGradient} text-white`,Oe=ce()(ie((n,s)=>({isLoading:!1,loadingMessage:"Loading...",progress:0,loadingStartTime:null,setLoading:(m,r="Loading...")=>{n({isLoading:m,loadingMessage:r,loadingStartTime:m?Date.now():null,progress:m?0:100})},setProgress:m=>n({progress:Math.min(Math.max(m,0),100)}),resetProgress:()=>n({progress:0})}))),Me=()=>{I.useEffect(()=>{const n=()=>{["/executive-summary","/sales-analytics","/funnel-leads","/client-retention","/trainer-performance"].forEach(r=>{const D=document.createElement("link");D.rel="prefetch",D.href=r,document.head.appendChild(D)})};if("requestIdleCallback"in window?requestIdleCallback(n):setTimeout(n,100),"PerformanceObserver"in window){const m=new PerformanceObserver(r=>{r.getEntries().forEach(D=>{D.entryType==="longtask"&&D.duration>100})});try{m.observe({entryTypes:["longtask"]})}catch{}}return(()=>{document.querySelectorAll('img[loading="lazy"]').forEach(r=>{if("IntersectionObserver"in window){const D=new IntersectionObserver(f=>{f.forEach(y=>{if(y.isIntersecting){const a=y.target;a.dataset.src&&(a.src=a.dataset.src,a.removeAttribute("data-src"),D.unobserve(a))}})});D.observe(r)}})})(),()=>{}},[])},xe=()=>{const n=new Date,s=new Date(n.getFullYear(),n.getMonth()-1,1),m=new Date(n.getFullYear(),n.getMonth(),0),r=f=>{const y=f.getFullYear(),a=String(f.getMonth()+1).padStart(2,"0"),p=String(f.getDate()).padStart(2,"0");return`${y}-${a}-${p}`};return{start:r(s),end:r(m)}},Ge=n=>{if(!n||n.trim()==="")return null;try{if(n.includes("/")){const r=n.split(" ")[0].trim().split("/");if(r.length===3){const D=parseInt(r[0]),f=parseInt(r[1]),y=parseInt(r[2]);if(!isNaN(y)&&!isNaN(f)&&!isNaN(D))return new Date(y,f-1,D)}}if(n.includes("-")){const m=new Date(n);if(!isNaN(m.getTime()))return m}const s=new Date(n);return isNaN(s.getTime())?null:s}catch{return null}},Ve=()=>{const n=new Date,s=new Date(n.getFullYear(),n.getMonth()-1,1);return`${s.toLocaleDateString("en-US",{month:"long"})} ${s.getFullYear()}`},x={CLIENT_ID:"416630995185-007ermh3iidknbbtdmu5vct207mdlbaa.apps.googleusercontent.com",CLIENT_SECRET:"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",REFRESH_TOKEN:"1//04w4V2xMUIMzACgYIARAAGAQSNwF-L9Ir5__pXDmZVYaHKOSqyauTDVmTvrCvgaL2beep4gmp8_lVED0ppM9BPWDDimHyQKk50EY",TOKEN_URL:"https://oauth2.googleapis.com/token"},ye="12xbYJQrh5wyYDaFhQrq4L0-YkSSlA6z7nMCb66XEbCQ",se=()=>{const[n,s]=I.useState([]),[m,r]=I.useState(!0),[D,f]=I.useState(null),y=async()=>{try{return(await(await fetch(x.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:x.CLIENT_ID,client_secret:x.CLIENT_SECRET,refresh_token:x.REFRESH_TOKEN,grant_type:"refresh_token"})})).json()).access_token}catch(t){throw t}},a=t=>{if(typeof t=="number")return t;if(!t||t==="")return 0;const c=t.toString().replace(/,/g,""),g=parseFloat(c);return isNaN(g)?0:g},p=async()=>{try{r(!0),f(null);const t=await y(),c=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${ye}/values/Sales?alt=json`,{headers:{Authorization:`Bearer ${t}`}});if(!c.ok)throw new Error("Failed to fetch data");const o=(await c.json()).values||[];if(o.length<2){s([]);return}const u=o[0],e=100,h=[],T=(E,i)=>{const N=o.slice(E,i).map(R=>{const d={};return u.forEach((w,L)=>{d[w]=R[L]||""}),{memberId:d["Member ID"]||d.memberId||"",customerName:d["Customer Name"]||d.customerName||"",customerEmail:d["Customer Email"]||d.customerEmail||"",saleItemId:d["Sale Item ID"]||d.saleItemId||"",paymentCategory:d["Payment Category"]||d.paymentCategory||"",membershipType:d["Membership Type"]||d.membershipType||"",paymentDate:d["Payment Date"]||d.paymentDate||"",paymentValue:a(d["Payment Value"]||d.paymentValue||0),paidInMoneyCredits:a(d["Paid in Money Credits"]||d["Paid In Money Credits"]||d.paidInMoneyCredits||0),paymentVAT:a(d["Payment VAT"]||d.paymentVAT||0),paymentItem:d["Payment Item"]||d.paymentItem||"",paymentStatus:d["Payment Status"]||d.paymentStatus||"",paymentMethod:d["Payment Method"]||d.paymentMethod||"",paymentTransactionId:d["Payment Transaction ID"]||d.paymentTransactionId||"",stripeToken:d["Stripe Token"]||d.stripeToken||"",soldBy:d["Sold By"]||d.soldBy||"",saleReference:d["Sale Reference"]||d.saleReference||"",calculatedLocation:d["Calculated Location"]||d.calculatedLocation||"",cleanedProduct:d["Cleaned Product"]||d.cleanedProduct||"",cleanedCategory:d["Cleaned Category"]||d.cleanedCategory||"",netRevenue:a(d["Payment Value"]||d.paymentValue||0)-a(d["Payment VAT"]||d.paymentVAT||0),vat:a(d["Payment VAT"]||d.paymentVAT||0),grossRevenue:a(d["Payment Value"]||d.paymentValue||0),mrpPreTax:a(d["Mrp - Pre Tax"]||d["MRP Pre Tax"]||d.MRP_Pre_Tax||d.mrpPreTax||d.MrpPreTax||d["Pre Tax MRP"]||0),mrpPostTax:a(d["Mrp - Post Tax"]||d["MRP Post Tax"]||d.MRP_Post_Tax||d.mrpPostTax||d.MrpPostTax||d["Post Tax MRP"]||0),discountAmount:a(d["Discount Amount -Mrp- Payment Value"]||d["Discount Amount"]||d.discount_amount||d.discountAmount||d.DiscountAmount||d.Discount_Amount||d["Total Discount"]||0),discountPercentage:a(d["Discount Percentage - discount amount/mrp*100"]||d["Discount Percentage"]||d.discount_percentage||d.discountPercentage||d.DiscountPercentage||d.Discount_Percentage||d["Discount %"]||d.Discount_Percent||0),hostId:d["Host Id"]||d["Host ID"]||d.hostId||""}});h.push(...N)},l=o.length-1;for(let E=1;E<=l;E+=e){const i=Math.min(E+e,l+1);E>1&&await new Promise(N=>setTimeout(N,0)),T(E,i)}s(h),f(null)}catch{f("Failed to load sales data")}finally{r(!1)}};return I.useEffect(()=>{p()},[]),{data:n,loading:m,error:D,refetch:p}},Fe={card:{shadow:"shadow-[0_4px_20px_rgba(0,0,0,0.08)]",border:"border border-slate-200/60",background:"bg-white/95 backdrop-blur-md",radius:"rounded-2xl"},table:{header:"bg-gradient-to-r from-slate-50 to-slate-100 border-b-2 border-slate-200",headerText:"text-xs font-bold text-slate-700 uppercase tracking-wider",row:"hover:bg-slate-50/80 transition-colors border-b border-slate-100",cell:"px-4 py-2 text-sm text-slate-800 font-medium whitespace-nowrap overflow-hidden text-ellipsis"}},v=n=>{if(n==null||isNaN(n))return"₹0";const s=Math.abs(n);return s<1e3?`₹${Math.round(n)}`:s>=1e7?`₹${(n/1e7).toFixed(1)}Cr`:s>=1e5?`₹${(n/1e5).toFixed(1)}L`:s>=1e3?`₹${(n/1e3).toFixed(1)}K`:`₹${n.toLocaleString("en-IN")}`},te=n=>n==null||isNaN(n)?"0.0%":`${n.toFixed(1)}%`,k=n=>n==null||isNaN(n)?"0":n.toLocaleString("en-IN"),$e=()=>{const{data:n,loading:s,error:m}=se();return{data:n,loading:s,error:m,isLoading:s}},G={CLIENT_ID:"416630995185-g7b0fm679lb4p45p5lou070cqscaalaf.apps.googleusercontent.com",CLIENT_SECRET:"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",REFRESH_TOKEN:"1//0gT2uoYBlNdGXCgYIARAAGBASNwF-L9IrBK_ijYwpce6-TdqDfji4GxYuc4uxIBKasdgoZBPm-tu_EU0xS34cNirqfLgXbJ8_NMk",TOKEN_URL:"https://oauth2.googleapis.com/token"},Te="149ILDqovzZA6FRUJKOwzutWdVqmqWBtWPfzG3A0zxTI",Be=()=>{const[n,s]=I.useState([]),[m,r]=I.useState(!0),[D,f]=I.useState(null),y=async()=>{try{return(await(await fetch(G.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:G.CLIENT_ID,client_secret:G.CLIENT_SECRET,refresh_token:G.REFRESH_TOKEN,grant_type:"refresh_token"})})).json()).access_token}catch(t){throw t}},a=t=>{if(typeof t=="number")return t;if(!t||t==="")return 0;const c=t.toString().replace(/,/g,""),g=parseFloat(c);return isNaN(g)?0:g},p=async()=>{try{r(!0);const t=await y(),c=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${Te}/values/Sessions?alt=json`,{headers:{Authorization:`Bearer ${t}`}});if(!c.ok)throw new Error("Failed to fetch sessions data");const o=(await c.json()).values||[];if(o.length<2){s([]);return}const u=o.slice(1).map(e=>{const h=a(e[6]),T=a(e[7]),l=h>0?T/h*100:0;return{trainerId:e[0]||"",trainerFirstName:e[1]||"",trainerLastName:e[2]||"",trainerName:e[3]||"",sessionId:e[4]||"",sessionName:e[5]||"",capacity:h,checkedInCount:T,lateCancelledCount:a(e[8]),bookedCount:a(e[9]),complimentaryCount:a(e[10]),location:e[11]||"",date:e[12]||"",dayOfWeek:e[13]||"",time:e[14]||"",totalPaid:a(e[15]),nonPaidCount:a(e[16]),uniqueId1:e[17]||"",uniqueId2:e[18]||"",checkedInsWithMemberships:a(e[19]),checkedInsWithPackages:a(e[20]),checkedInsWithIntroOffers:a(e[21]),checkedInsWithSingleClasses:a(e[22]),classType:e[23]||"",cleanedClass:e[24]||"",classes:a(e[25]),fillPercentage:l,revenue:a(e[15]),uniqueId:e[17]||""}});s(u),f(null)}catch{f("Failed to load sessions data")}finally{r(!1)}};return I.useEffect(()=>{p()},[]),{data:n,loading:m,error:D,refetch:p}},V={CLIENT_ID:"416630995185-007ermh3iidknbbtdmu5vct207mdlbaa.apps.googleusercontent.com",CLIENT_SECRET:"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",REFRESH_TOKEN:"1//04pAfj5ZB3ahLCgYIARAAGAQSNwF-L9IrqCo4OyUjAbO1hP5bR3vhs8K96zDZkbeCzcuCjzEiBPZ3O639cLRkUduicMYK1Rzs5GY",TOKEN_URL:"https://oauth2.googleapis.com/token"},De="149ILDqovzZA6FRUJKOwzutWdVqmqWBtWPfzG3A0zxTI",Ue=()=>{const[n,s]=I.useState([]),[m,r]=I.useState(!0),[D,f]=I.useState(null),y=async()=>{try{return(await(await fetch(V.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:V.CLIENT_ID,client_secret:V.CLIENT_SECRET,refresh_token:V.REFRESH_TOKEN,grant_type:"refresh_token"})})).json()).access_token}catch(t){throw t}},a=t=>{if(typeof t=="number")return t;if(!t||t==="")return 0;const c=t.toString().replace(/,/g,""),g=parseFloat(c);return isNaN(g)?0:g},p=async()=>{try{r(!0);const t=await y(),c=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${De}/values/Payroll?alt=json`,{headers:{Authorization:`Bearer ${t}`}});if(!c.ok)throw new Error(`Failed to fetch payroll data: ${c.status} ${c.statusText}`);const o=(await c.json()).values||[];if(o.length<2){s([]);return}const u=o.slice(1).map(e=>({teacherId:e[0]||"",teacherName:e[1]||"",teacherEmail:e[2]||"",location:e[3]||"",cycleSessions:a(e[4]),emptyCycleSessions:a(e[5]),nonEmptyCycleSessions:a(e[6]),cycleCustomers:a(e[7]),cyclePaid:a(e[8]),strengthSessions:a(e[9]),emptyStrengthSessions:a(e[10]),nonEmptyStrengthSessions:a(e[11]),strengthCustomers:a(e[12]),strengthPaid:a(e[13]),barreSessions:a(e[14]),emptyBarreSessions:a(e[15]),nonEmptyBarreSessions:a(e[16]),barreCustomers:a(e[17]),barrePaid:a(e[18]),totalSessions:a(e[19]),totalEmptySessions:a(e[20]),totalNonEmptySessions:a(e[21]),totalCustomers:a(e[22]),totalPaid:a(e[23]),monthYear:e[24]||"",unique:e[25]||"",converted:a(e[26]),conversion:a(e[27]).toString()+"%",retained:a(e[28]),retention:a(e[29]).toString()+"%",new:a(e[30]),classAverageInclEmpty:a(e[22])>0?a(e[19])/a(e[22]):0,classAverageExclEmpty:a(e[21])>0?a(e[22])/a(e[21]):0}));s(u),f(null)}catch{f("Failed to load payroll data")}finally{r(!1)}};return I.useEffect(()=>{p()},[]),{data:n,isLoading:m,error:D,refetch:p}},F={CLIENT_ID:"416630995185-007ermh3iidknbbtdmu5vct207mdlbaa.apps.googleusercontent.com",CLIENT_SECRET:"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",REFRESH_TOKEN:"1//04pAfj5ZB3ahLCgYIARAAGAQSNwF-L9IrqCo4OyUjAbO1hP5bR3vhs8K96zDZkbeCzcuCjzEiBPZ3O639cLRkUduicMYK1Rzs5GY",TOKEN_URL:"https://oauth2.googleapis.com/token"},Ie="149ILDqovzZA6FRUJKOwzutWdVqmqWBtWPfzG3A0zxTI",ze=()=>{const[n,s]=I.useState([]),[m,r]=I.useState(!0),[D,f]=I.useState(null),[y,a]=I.useState(!1),p=async()=>{try{return(await(await fetch(F.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:F.CLIENT_ID,client_secret:F.CLIENT_SECRET,refresh_token:F.REFRESH_TOKEN,grant_type:"refresh_token"})})).json()).access_token}catch(o){throw o}},t=(o,u)=>{if(!o||!u)return 0;let e,h;if(o.includes("/")){const[E,i,N]=o.split(" ")[0].split("/");e=new Date(parseInt(N),parseInt(i)-1,parseInt(E))}else e=new Date(o);if(u.includes("/")){const[E,i,N]=u.split(" ")[0].split("/");h=new Date(parseInt(N),parseInt(i)-1,parseInt(E))}else h=new Date(u);if(isNaN(e.getTime())||isNaN(h.getTime()))return 0;const T=h.getTime()-e.getTime(),l=Math.ceil(T/(1e3*60*60*24));return Math.max(0,l)},c=(o="")=>{if(!o)return"";let u;if(o.includes("/")){const T=o.split(",")[0].trim(),[l,E,i]=T.split("/");u=new Date(parseInt(i),parseInt(E)-1,parseInt(l))}else u=new Date(o);if(isNaN(u.getTime()))return"";const e=u.getFullYear(),h=(u.getMonth()+1).toString().padStart(2,"0");return`${e}-${h}`},g=async()=>{try{y&&r(!0);const o=await p(),u=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${Ie}/values/New?alt=json`,{headers:{Authorization:`Bearer ${o}`}});if(!u.ok)throw new Error("Failed to fetch new client data");const h=(await u.json()).values||[];if(h.length<2){s([]);return}const T=h.slice(1).map(l=>{const E=l[5]||"";return{memberId:l[0]||"",firstName:l[1]||"",lastName:l[2]||"",email:l[3]||"",phoneNumber:l[4]||"",firstVisitDate:E,firstVisitEntityName:l[6]||"",firstVisitType:l[7]||"",firstVisitLocation:l[8]||"",paymentMethod:l[9]||"",membershipUsed:l[10]||"",homeLocation:l[11]||"",classNo:parseFloat(l[12])||0,trainerName:l[13]||"",isNew:l[14]||"",visitsPostTrial:parseFloat(l[15])||0,membershipsBoughtPostTrial:l[16]||"",purchaseCountPostTrial:parseFloat(l[17])||0,ltv:parseFloat(l[18])||0,retentionStatus:l[19]||"",conversionStatus:l[20]||"",period:l[21]||"",unique:l[22]||"",firstPurchase:l[23]||"",conversionSpan:t(E,l[23]||""),monthYear:c(E)}});s(T),f(null),a(!0)}catch{f("Failed to load new client data"),a(!0)}finally{r(!1)}};return I.useEffect(()=>{y||g()},[y]),{data:n,loading:m,error:D,refetch:g}},$={CLIENT_ID:"416630995185-g7b0fm679lb4p45p5lou070cqscaalaf.apps.googleusercontent.com",CLIENT_SECRET:"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",REFRESH_TOKEN:"1//0gT2uoYBlNdGXCgYIARAAGBASNwF-L9IrBK_ijYwpce6-TdqDfji4GxYuc4uxIBKasdgoZBPm-tu_EU0xS34cNirqfLgXbJ8_NMk",TOKEN_URL:"https://oauth2.googleapis.com/token"},be="1dQMNF69WnXVQdhlLvUZTig3kL97NA21k6eZ9HRu6xiQ",_=n=>{if(!n||n.trim()===""||n==="-")return"";try{let s;const m=new Date;if(n.includes("/")){const r=n.split("/");if(r.length===3){const D=parseInt(r[0]),f=parseInt(r[1]),y=parseInt(r[2]);!isNaN(y)&&!isNaN(f)&&!isNaN(D)&&(s=new Date(y,f-1,D))}}else n.includes("-")?s=new Date(n):s=new Date(n);return!s||isNaN(s.getTime())||s>m||s.getFullYear()<2020?"":s.toISOString()}catch{return""}},b=(n,s)=>n&&n[s]!==void 0&&n[s]!==null?String(n[s]).trim():"",Ee=(n,s)=>{const m=b(n,s),r=parseFloat(m);return isNaN(r)?0:r},ae=(n,s)=>{const m=b(n,s),r=parseInt(m);return isNaN(r)?0:r},je=()=>{const[n,s]=I.useState([]),[m,r]=I.useState(!0),[D,f]=I.useState(null),y=async()=>{try{const p=await fetch($.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:$.CLIENT_ID,client_secret:$.CLIENT_SECRET,refresh_token:$.REFRESH_TOKEN,grant_type:"refresh_token"})});if(!p.ok)throw new Error(`Token request failed: ${p.statusText}`);const t=await p.json();if(!t.access_token)throw new Error("No access token received");return t.access_token}catch(p){throw p}},a=async()=>{try{r(!0),f(null);const p=await y(),t=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${be}/values/◉ Leads?alt=json`,{headers:{Authorization:`Bearer ${p}`}});if(!t.ok)throw new Error(`Failed to fetch leads data: ${t.statusText}`);const g=(await t.json()).values||[];if(g.length<2){s([]);return}const o=g.slice(1).map((u,e)=>{try{return!u||u.length===0?null:{id:b(u,0),fullName:b(u,1),phone:b(u,2),email:b(u,3),createdAt:_(b(u,4)),sourceId:b(u,5),source:b(u,6),memberId:b(u,7),convertedToCustomerAt:_(b(u,8)),stage:b(u,9),associate:b(u,10),remarks:b(u,11),followUp1Date:_(b(u,12)),followUpComments1:b(u,13),followUp2Date:_(b(u,14)),followUpComments2:b(u,15),followUp3Date:_(b(u,16)),followUpComments3:b(u,17),followUp4Date:_(b(u,18)),followUpComments4:b(u,19),center:b(u,20),classType:b(u,21),hostId:b(u,22),status:b(u,23),channel:b(u,24),period:b(u,25),purchasesMade:ae(u,26),ltv:Ee(u,27),visits:ae(u,28),trialStatus:b(u,29),conversionStatus:b(u,30),retentionStatus:b(u,31)}}catch{return null}}).filter(u=>u!==null);s(o),f(null)}catch(p){f(p instanceof Error?p.message:"Failed to load leads data")}finally{r(!1)}};return I.useEffect(()=>{a()},[]),{data:n,loading:m,error:D,refetch:a}},He=()=>{const{data:n,loading:s,error:m}=se(),[r,D]=I.useState([]);I.useEffect(()=>{if(n&&n.length>0)try{const y=t=>{if(t==null||t==="")return 0;const c=t.toString().replace(/[₹,]/g,"").trim(),g=parseFloat(c);return isNaN(g)?0:g},a=t=>{if(!t)return"";try{if(t.includes("/")){const c=t.split(",")[0].trim(),[g,o,u]=c.split("/");if(g&&o&&u){const e=`${u}-${o.padStart(2,"0")}-${g.padStart(2,"0")}`;return new Date(e).toISOString().split("T")[0]}}if(t.includes("-")){const c=new Date(t);if(!isNaN(c.getTime()))return c.toISOString().split("T")[0]}return""}catch{return""}},p=n.map(t=>{const c=y(t.discountAmount||t["Discount Amount -Mrp- Payment Value"]||0),g=y(t.discountPercentage||t["Discount Percentage - discount amount/mrp*100"]||0);return{memberId:t.memberId||t["Member ID"]?.toString()||"",customerName:t.customerName||t["Customer Name"]||"",customerEmail:t.customerEmail||t["Customer Email"]||"",saleItemId:t.saleItemId||t["Sale Item ID"]?.toString()||"",paymentCategory:t.paymentCategory||t["Payment Category"]||"",paymentDate:a(t.paymentDate||t["Payment Date"]||""),paymentValue:y(t.paymentValue||t["Payment Value"]||0),paidInMoneyCredits:y(t.paidInMoneyCredits||t["Paid In Money Credits"]||0),paymentVat:y(t.paymentVat||t["Payment VAT"]||0),paymentItem:t.paymentItem||t["Payment Item"]||"",paymentMethod:t.paymentMethod||t["Payment Method"]||"",paymentStatus:t.paymentStatus||t["Payment Status"]||"",paymentTransactionId:t.paymentTransactionId||t["Payment Transaction ID"]?.toString()||"",stripeToken:t.stripeToken||t["Stripe Token"]||"",saleReference:t.saleReference||t["Sale Reference"]?.toString()||"",soldBy:t.soldBy==="-"?"Online/System":t.soldBy||t["Sold By"]||"Unknown",location:t.calculatedLocation||t["Calculated Location"]||"",cleanedProduct:t.cleanedProduct||t["Cleaned Product"]||"",cleanedCategory:t.cleanedCategory||t["Cleaned Category"]||"",hostId:t.hostId||t["Host Id"]?.toString()||"",mrpPreTax:y(t.mrpPreTax||t["Mrp - Pre Tax"]||0),mrpPostTax:y(t.mrpPostTax||t["Mrp - Post Tax"]||0),discountAmount:c,discountPercentage:g,membershipType:t.membershipType||t["Membership Type"]?.trim()||""}});D(p)}catch{D([])}else D([])},[n]);const f=I.useMemo(()=>{if(!r.length)return{totalDiscountAmount:0,totalRevenueLost:0,totalTransactions:0,avgDiscountPercentage:0,totalPotentialRevenue:0,totalActualRevenue:0,discountEffectiveness:0,productBreakdown:[],monthlyBreakdown:[]};const y=r.reduce((e,h)=>e+(h.discountAmount||0),0),a=r.length,p=r.reduce((e,h)=>e+(h.mrpPostTax||h.paymentValue||0),0),t=r.reduce((e,h)=>e+(h.paymentValue||0),0),c=r.filter(e=>(e.discountAmount||0)>0),g=c.length>0?c.reduce((e,h)=>e+(h.discountPercentage||0),0)/c.length:0,o=r.reduce((e,h)=>{const T=h.cleanedProduct||"Unknown Product";return e[T]||(e[T]={product:T,transactions:0,totalDiscount:0,avgDiscountPercentage:0,revenue:0,totalMrp:0}),e[T].transactions+=1,e[T].totalDiscount+=h.discountAmount||0,e[T].revenue+=h.paymentValue||0,e[T].totalMrp+=h.mrpPostTax||h.paymentValue||0,e},{});Object.values(o).forEach(e=>{e.avgDiscountPercentage=e.totalMrp>0?e.totalDiscount/e.totalMrp*100:0});const u=r.reduce((e,h)=>{if(!h.paymentDate)return e;const T=h.paymentDate.substring(0,7);return e[T]||(e[T]={month:T,transactions:0,totalDiscount:0,revenue:0}),e[T].transactions+=1,e[T].totalDiscount+=h.discountAmount||0,e[T].revenue+=h.paymentValue||0,e},{});return{totalDiscountAmount:y,totalRevenueLost:y,totalTransactions:a,avgDiscountPercentage:g,totalPotentialRevenue:p,totalActualRevenue:t,discountEffectiveness:p>0?t/p*100:0,productBreakdown:Object.values(o),monthlyBreakdown:Object.values(u)}},[r]);return{data:r,metrics:f,loading:s,error:m}},Ke=()=>{const[n,s]=I.useState(!1),m=(a,p)=>[p.join(","),...a.map(c=>p.map(g=>{const o=c[g];return o==null?"":typeof o=="string"&&o.includes(",")?`"${o.replace(/"/g,'""')}"`:o}).join(","))].join(`
`),r=(a,p)=>{const t=new Blob([a],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a"),g=URL.createObjectURL(t);c.setAttribute("href",g),c.setAttribute("download",p),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)},D=(a,p)=>{const t=new le("l","mm","a4"),c=t.internal.pageSize.getWidth();t.internal.pageSize.getHeight(),t.setFontSize(20),t.setTextColor(40,40,40),t.text("Complete Dashboard Export",c/2,20,{align:"center"}),t.setFontSize(10),t.setTextColor(100,100,100);const g=M(new Date,"PPP p");t.text(`Generated on: ${g}`,20,30),p.dateRange&&t.text(`Date Range: ${M(new Date(p.dateRange.start),"PP")} - ${M(new Date(p.dateRange.end),"PP")}`,20,35);let o=45;return a.salesData&&a.salesData.length>0&&(o=f(t,"Sales Analytics Data",a.salesData,o,["customerName","paymentDate","membershipType","paymentValue","calculatedLocation","soldBy","paymentMethod"])),a.sessionsData&&a.sessionsData.length>0&&(o=f(t,"Sessions Data",a.sessionsData,o,["date","classType","instructor","location","capacity","checkedIn","fillPercentage"])),a.newClientData&&a.newClientData.length>0&&(o=f(t,"Client Conversion Data",a.newClientData,o,["firstName","lastName","email","firstVisitDate","firstVisitLocation","conversionStatus","ltv"])),a.payrollData&&a.payrollData.length>0&&(o=f(t,"Trainer Performance Data",a.payrollData,o,["teacherName","location","totalSessions","totalCustomers","totalPaid","conversion","retention"])),a.lateCancellationsData&&a.lateCancellationsData.length>0&&(o=f(t,"Late Cancellations Data",a.lateCancellationsData,o,["firstName","lastName","sessionName","teacherName","location","dateIST","time"])),a.discountData&&a.discountData.length>0&&(o=f(t,"Discounts & Promotions Data",a.discountData,o,["firstName","lastName","cleanedProduct","mrpPostTax","discountAmount","discountPercentage","location"])),a.additionalData&&Object.entries(a.additionalData).forEach(([u,e])=>{if(e&&e.length>0){const h=Object.keys(e[0]).slice(0,7);o=f(t,u,e,o,h)}}),t},f=(a,p,t,c,g)=>{const o=a.internal.pageSize.getHeight();c>o-100&&(a.addPage(),c=20),a.setFontSize(14),a.setTextColor(60,60,60),a.text(p,20,c),c+=10;const u=t.slice(0,100).map(e=>g.map(h=>{const T=e[h];return T==null?"":typeof T=="number"?T.toLocaleString():String(T)}));return a.autoTable({head:[g.map(e=>e.charAt(0).toUpperCase()+e.slice(1).replace(/([A-Z])/g," $1"))],body:u,startY:c,styles:{fontSize:8,cellPadding:2},headStyles:{fillColor:[66,139,202],textColor:255,fontSize:9,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:20,right:20}}),a.lastAutoTable.finalY+15};return{exportAllData:async(a,p)=>{s(!0);try{const t=p.fileName||`dashboard-export-${M(new Date,"yyyy-MM-dd-HH-mm")}`;if(p.format==="pdf")D(a,p).save(`${t}.pdf`);else if(p.format==="csv"){let c="";const g=[];if(a.salesData?.length){const o=Object.keys(a.salesData[0]);c+=`Sales Analytics Data
${m(a.salesData,o)}

`,g.push("Sales")}if(a.sessionsData?.length){const o=Object.keys(a.sessionsData[0]);c+=`Sessions Data
${m(a.sessionsData,o)}

`,g.push("Sessions")}if(a.newClientData?.length){const o=Object.keys(a.newClientData[0]);c+=`Client Conversion Data
${m(a.newClientData,o)}

`,g.push("Client Conversion")}if(a.payrollData?.length){const o=Object.keys(a.payrollData[0]);c+=`Trainer Performance Data
${m(a.payrollData,o)}

`,g.push("Trainer Performance")}if(a.lateCancellationsData?.length){const o=Object.keys(a.lateCancellationsData[0]);c+=`Late Cancellations Data
${m(a.lateCancellationsData,o)}

`,g.push("Late Cancellations")}if(a.discountData?.length){const o=Object.keys(a.discountData[0]);c+=`Discounts & Promotions Data
${m(a.discountData,o)}

`,g.push("Discounts")}a.additionalData&&Object.entries(a.additionalData).forEach(([o,u])=>{if(u?.length){const e=Object.keys(u[0]);c+=`${o}
${m(u,e)}

`,g.push(o)}}),r(c,`${t}.csv`)}}catch(t){throw t}finally{s(!1)}},isExporting:n}},Ye=n=>{const{filters:s}=de();return{metrics:I.useMemo(()=>{if(!n||n.length===0)return[];const r=n,D=n.length,f=Math.floor(D/2),y=r.slice(0,f);r.slice(f);const a=r.reduce((S,C)=>S+(typeof C.paymentValue=="number"?C.paymentValue:0),0),p=r.reduce((S,C)=>S+(typeof C.discountAmount=="number"?C.discountAmount:0),0),t=r.length,c=new Set(r.map(S=>S.memberId||S.customerEmail).filter(Boolean)).size,g=r.length,o=t>0?a/t:0,u=c>0?a/c:0,e=r.length>0?r.reduce((S,C)=>S+(typeof C.discountPercentage=="number"?C.discountPercentage:0),0)/r.length:0,h=y.reduce((S,C)=>S+(typeof C.paymentValue=="number"?C.paymentValue:0),0),T=y.reduce((S,C)=>S+(typeof C.discountAmount=="number"?C.discountAmount:0),0),l=y.length,E=new Set(y.map(S=>S.memberId||S.customerEmail).filter(Boolean)).size,i=y.length,N=l>0?h/l:0,R=E>0?h/E:0,d=y.length>0?y.reduce((S,C)=>S+(typeof C.discountPercentage=="number"?C.discountPercentage:0),0)/y.length:0,P=(S,C)=>{if(C===0)return{rate:S>0?100:0,isSignificant:S>0,trend:"moderate"};const O=(S-C)/C*100,re=Math.abs(O)>=5,oe=Math.abs(O)>=20?"strong":Math.abs(O)>=10?"moderate":"weak";return{rate:O,isSignificant:re,trend:oe}},w=P(a,h),L=P(t,l),Y=P(c,E),q=P(g,i),W=P(o,N),Q=P(u,R),Z=P(p,T),X=P(e,d);return[{title:"Sales Revenue",value:v(a),rawValue:a,change:w.rate,changeDetails:w,icon:"DollarSign",color:"blue",description:"Total sales revenue across all transactions",previousValue:v(h),previousRawValue:h,comparison:{current:a,previous:h,difference:a-h}},{title:"Units Sold",value:k(g),rawValue:g,change:q.rate,changeDetails:q,icon:"ShoppingCart",color:"green",description:"Total number of units/items sold",previousValue:k(i),previousRawValue:i,comparison:{current:g,previous:i,difference:g-i}},{title:"Transactions",value:k(t),rawValue:t,change:L.rate,changeDetails:L,icon:"Activity",color:"purple",description:"Number of completed transactions",previousValue:k(l),previousRawValue:l,comparison:{current:t,previous:l,difference:t-l}},{title:"Unique Members",value:k(c),rawValue:c,change:Y.rate,changeDetails:Y,icon:"Users",color:"orange",description:"Individual customers who made purchases",previousValue:k(E),previousRawValue:E,comparison:{current:c,previous:E,difference:c-E}},{title:"Avg Transaction Value",value:v(o),rawValue:o,change:W.rate,changeDetails:W,icon:"Target",color:"cyan",description:"Average value per transaction",previousValue:v(N),previousRawValue:N,comparison:{current:o,previous:N,difference:o-N}},{title:"Avg Spend per Member",value:v(u),rawValue:u,change:Q.rate,changeDetails:Q,icon:"Calendar",color:"pink",description:"Average spending per unique customer",previousValue:v(R),previousRawValue:R,comparison:{current:u,previous:R,difference:u-R}},{title:"Discount Value",value:v(p),rawValue:p,change:Z.rate,changeDetails:Z,icon:"CreditCard",color:"red",description:"Total discount amount applied",previousValue:v(T),previousRawValue:T,comparison:{current:p,previous:T,difference:p-T}},{title:"Discount Percentage",value:te(e/100),rawValue:e,change:X.rate,changeDetails:X,icon:"ArrowDownRight",color:"amber",description:"Average discount rate applied",previousValue:te(d/100),previousRawValue:d,comparison:{current:e,previous:d,difference:e-d}}]},[n,s.dateRange])}},qe=n=>{let s=null;try{s=ue().filters}catch{s=null}return I.useMemo(()=>n?n.filter(r=>{const D=r.sessionName?.toLowerCase()||"";if(D.includes("test")||D.includes("demo"))return!1;if(!s)return!0;if(s.trainers.length>0&&!s.trainers.includes(r.trainerName)||s.classTypes.length>0&&!s.classTypes.includes(r.cleanedClass)||s.dayOfWeek.length>0&&!s.dayOfWeek.includes(r.dayOfWeek)||s.timeSlots.length>0&&!s.timeSlots.includes(r.time))return!1;if(s.dateRange.start||s.dateRange.end){let f;if(r.date.includes("/")){const a=r.date.split("/");if(a.length===3){const p=parseInt(a[0]),t=parseInt(a[1]),c=parseInt(a[2]);f=new Date(c,t-1,p)}else f=new Date(r.date)}else f=new Date(r.date);if(isNaN(f.getTime()))return!0;const y=new Date(f.getFullYear(),f.getMonth(),f.getDate());if(s.dateRange.start){const a=new Date(s.dateRange.start.getFullYear(),s.dateRange.start.getMonth(),s.dateRange.start.getDate());if(y<a)return!1}if(s.dateRange.end){const a=new Date(s.dateRange.end.getFullYear(),s.dateRange.end.getMonth(),s.dateRange.end.getDate());if(y>a)return!1}}return!0}):[],[n,s])},B={CLIENT_ID:"416630995185-007ermh3iidknbbtdmu5vct207mdlbaa.apps.googleusercontent.com",CLIENT_SECRET:"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",REFRESH_TOKEN:"1//04w4V2xMUIMzACgYIARAAGAQSNwF-L9Ir5__pXDmZVYaHKOSqyauTDVmTvrCvgaL2beep4gmp8_lVED0ppM9BPWDDimHyQKk50EY",TOKEN_URL:"https://oauth2.googleapis.com/token"},Se="1rGMDDvvTbZfNg1dueWtRN3LhOgGQOdLg3Fd7Sn1GCZo",We=()=>{const[n,s]=I.useState([]),[m,r]=I.useState(!0),[D,f]=I.useState(null),y=async()=>{try{return(await(await fetch(B.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:B.CLIENT_ID,client_secret:B.CLIENT_SECRET,refresh_token:B.REFRESH_TOKEN,grant_type:"refresh_token"})})).json()).access_token}catch(p){throw p}},a=async()=>{try{r(!0),f(null);const p=await y(),t=["Expirations","Expiration","Members","Sheet1","Data"];let c,g="";for(const T of t)try{if(c=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${Se}/values/${T}?alt=json`,{headers:{Authorization:`Bearer ${p}`}}),c.ok){g=T;break}}catch{continue}if(!c||!c.ok)throw new Error(`Failed to fetch expirations data from any sheet. Tried: ${t.join(", ")}`);const u=(await c.json()).values||[];if(u.length<2){s([]);return}const e=u[0],h=[];for(let T=1;T<u.length;T++){const l=u[T];if(!l||l.length===0)continue;const E={uniqueId:l[e.findIndex(i=>i==="Unique Id")]||`exp-${Date.now()}-${T}`,memberId:l[e.findIndex(i=>i==="Member ID")]||"",firstName:l[e.findIndex(i=>i==="First Name")]||"",lastName:l[e.findIndex(i=>i==="Last Name")]||"",email:l[e.findIndex(i=>i==="Email")]||"",membershipName:l[e.findIndex(i=>i==="Membership Name")]||"",endDate:l[e.findIndex(i=>i==="End Date")]||"",homeLocation:l[e.findIndex(i=>i==="Home Location")]||"",currentUsage:l[e.findIndex(i=>i==="Current Usage")]||"",id:l[e.findIndex(i=>i==="Id")]||"",orderAt:l[e.findIndex(i=>i==="Order At")]||"",soldBy:l[e.findIndex(i=>i==="Sold By")]||"",membershipId:l[e.findIndex(i=>i==="Membership Id")]||"",frozen:l[e.findIndex(i=>i==="Frozen")]==="TRUE",paid:l[e.findIndex(i=>i==="Paid")]||"",status:l[e.findIndex(i=>i==="Status")]||""};h.push(E)}s(h),f(null)}catch(p){f(p instanceof Error?p.message:"Failed to load expirations data"),s([])}finally{r(!1)}};return I.useEffect(()=>{a()},[]),{data:n,loading:m,error:D||"",refetch:a}},U={CLIENT_ID:"416630995185-007ermh3iidknbbtdmu5vct207mdlbaa.apps.googleusercontent.com",CLIENT_SECRET:"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",REFRESH_TOKEN:"1//04w4V2xMUIMzACgYIARAAGAQSNwF-L9Ir5__pXDmZVYaHKOSqyauTDVmTvrCvgaL2beep4gmp8_lVED0ppM9BPWDDimHyQKk50EY",TOKEN_URL:"https://oauth2.googleapis.com/token"},Ce="149ILDqovzZA6FRUJKOwzutWdVqmqWBtWPfzG3A0zxTI",Qe=()=>{const[n,s]=I.useState([]),[m,r]=I.useState(!0),[D,f]=I.useState(null),y=async()=>{try{return(await(await fetch(U.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:U.CLIENT_ID,client_secret:U.CLIENT_SECRET,refresh_token:U.REFRESH_TOKEN,grant_type:"refresh_token"})})).json()).access_token}catch(t){throw t}},a=t=>{if(typeof t=="number")return t;if(!t||t==="")return 0;const c=t.toString();if(c.includes("-")&&(c.includes("1899")||c.includes("1900")))return 0;const g=c.replace(/,/g,""),o=parseFloat(g);return isNaN(o)?0:o},p=async()=>{try{r(!0),f(null);const t=await y(),c=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${Ce}/values/Checkins?alt=json`,{headers:{Authorization:`Bearer ${t}`}});if(!c.ok)throw new Error("Failed to fetch late cancellations data");const o=(await c.json()).values||[];if(o.length<2){s([]);return}const u=[];if(o.length<2){s([]);return}const e=o[0],h=e.findIndex(T=>T==="Is Late Cancelled");if(h===-1){s([]);return}for(let T=1;T<o.length;T++){const l=o[T];if(!l||l.length===0||l[h]!=="TRUE")continue;const E={memberId:l[e.findIndex(i=>i==="Member ID")]||"",firstName:l[e.findIndex(i=>i==="First Name")]||"",lastName:l[e.findIndex(i=>i==="Last Name")]||"",email:l[e.findIndex(i=>i==="Email")]||"",location:l[e.findIndex(i=>i==="Location")]||"",sessionName:l[e.findIndex(i=>i==="Session Name")]||"",teacherName:l[e.findIndex(i=>i==="Teacher Name")]||"",cleanedProduct:l[e.findIndex(i=>i==="Cleaned Product")]||"",cleanedCategory:l[e.findIndex(i=>i==="Cleaned Category")]||"",cleanedClass:l[e.findIndex(i=>i==="Cleaned Class")]||"",paymentMethodName:l[e.findIndex(i=>i==="Payment Method Name")]||"",dateIST:l[e.findIndex(i=>i==="Date (IST)")]||"",dayOfWeek:l[e.findIndex(i=>i==="Day of Week")]||"",time:l[e.findIndex(i=>i==="Time")]||"",duration:a(l[e.findIndex(i=>i==="Duration (Minutes)")]||"0"),capacity:a(l[e.findIndex(i=>i==="Capacity")]||"0"),month:l[e.findIndex(i=>i==="Month")]||"",year:a(l[e.findIndex(i=>i==="Year")]||"0"),paidAmount:a(l[e.findIndex(i=>i==="Paid")]||"0"),isNew:l[e.findIndex(i=>i==="Is New")]||"",tableType:"checkins"};u.push(E)}s(u),f(null)}catch{f("Failed to load late cancellations data"),s([])}finally{r(!1)}};return I.useEffect(()=>{p()},[]),{data:n,loading:m,error:D,refetch:p}};export{Le as a,te as b,k as c,qe as d,Ue as e,v as f,xe as g,Fe as h,Ve as i,Oe as j,$e as k,ze as l,je as m,He as n,ne as o,we as p,Ge as q,Ye as r,se as s,We as t,Be as u,Qe as v,Ae as w,Ke as x,Me as y};
